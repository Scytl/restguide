<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.2">
<meta name="author" content="Architecture">
<title>REST</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Remove the comments around the @import statement below when using this as a custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
[hidden],template{display:none}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
body{margin:0}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}
input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
#map_canvas img,#map_canvas embed,#map_canvas object,.map_canvas img,.map_canvas embed,.map_canvas object{max-width:none!important}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
.antialiased,body{-webkit-font-smoothing:antialiased}
img{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
p.lead,.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{font-size:1.21875em;line-height:1.6}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol,ul.no-bullet,ol.no-bullet{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.no-bullet{list-style:none}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite:before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media only screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7;font-weight:bold}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix:before,.clearfix:after,.float-group:before,.float-group:after{content:" ";display:table}
.clearfix:after,.float-group:after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
.keyseq{color:rgba(51,51,51,.8)}
kbd{display:inline-block;color:rgba(0,0,0,.8);font-size:.75em;line-height:1.4;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:-.15em .15em 0 .15em;padding:.2em .6em .2em .5em;vertical-align:middle;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menu{color:rgba(0,0,0,.8)}
b.button:before,b.button:after{position:relative;top:-1px;font-weight:400}
b.button:before{content:"[";padding:0 3px 0 2px}
b.button:after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header:before,#header:after,#content:before,#content:after,#footnotes:before,#footnotes:after,#footer:before,#footer:after{content:" ";display:table}
#header:after,#content:after,#footnotes:after,#footer:after{clear:both}
#content{margin-top:1.25em}
#content:before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span:before{content:"\00a0\2013\00a0"}
#header .details br+span.author:before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark:before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber:after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media only screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}@media only screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
.sect1{padding-bottom:.625em}
@media only screen and (min-width:768px){.sect1{padding-bottom:1.25em}}.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor:before,h2>a.anchor:before,h3>a.anchor:before,#toctitle>a.anchor:before,.sidebarblock>.content>.title>a.anchor:before,h4>a.anchor:before,h5>a.anchor:before,h6>a.anchor:before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock>caption.title{white-space:nowrap;overflow:visible;max-width:0}
.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media only screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}@media only screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]:before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]:before{display:block}
.listingblock.terminal pre .command:before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt]):before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote:before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote:before{display:none}
.verseblock{margin:0 1em 1.25em 1em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.05em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 0 1.25em 0;display:block}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{text-align:left;word-spacing:0}
.quoteblock.abstract blockquote:before,.quoteblock.abstract blockquote p:first-of-type:before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
table.tableblock td>.paragraph:last-child p>p:last-child,table.tableblock th>p:last-child,table.tableblock td>p:last-child{margin-bottom:0}
table.spread{width:100%}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all th.tableblock,table.grid-all td.tableblock{border-width:0 1px 1px 0}
table.grid-all tfoot>tr>th.tableblock,table.grid-all tfoot>tr>td.tableblock{border-width:1px 1px 0 0}
table.grid-cols th.tableblock,table.grid-cols td.tableblock{border-width:0 1px 0 0}
table.grid-all *>tr>.tableblock:last-child,table.grid-cols *>tr>.tableblock:last-child{border-right-width:0}
table.grid-rows th.tableblock,table.grid-rows td.tableblock{border-width:0 0 1px 0}
table.grid-all tbody>tr:last-child>th.tableblock,table.grid-all tbody>tr:last-child>td.tableblock,table.grid-all thead:last-child>tr>th.tableblock,table.grid-rows tbody>tr:last-child>th.tableblock,table.grid-rows tbody>tr:last-child>td.tableblock,table.grid-rows thead:last-child>tr>th.tableblock{border-bottom-width:0}
table.grid-rows tfoot>tr>th.tableblock,table.grid-rows tfoot>tr>td.tableblock{border-width:1px 0 0 0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot{border-width:1px 0}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.unstyled,ol.unnumbered,ul.checklist,ul.none{list-style-type:none}
ul.unstyled,ol.unnumbered,ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1em;font-size:.85em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{width:1em;position:relative;top:1px}
ul.inline{margin:0 auto .625em auto;margin-left:-1.375em;margin-right:0;padding:0;list-style:none;overflow:hidden}
ul.inline>li{list-style:none;float:left;margin-left:1.375em;display:block}
ul.inline>li>*{display:block}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1{padding-right:.75em;font-weight:bold}
td.hdlist1,td.hdlist2{vertical-align:top}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist>table tr>td:first-of-type{padding:0 .75em;line-height:1}
.colist>table tr>td:last-of-type{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none}
span.footnote,span.footnoteref{vertical-align:super;font-size:.875em}
span.footnote a,span.footnoteref a{text-decoration:none}
span.footnote a:active,span.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em 0;border-width:1px 0 0 0}
#footnotes .footnote{padding:0 .375em;line-height:1.3;font-size:.875em;margin-left:1.2em;text-indent:-1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
h1,h2{letter-spacing:-.01em}
dt,th.tableblock,td.content{text-rendering:optimizeLegibility}
p,td.content{letter-spacing:-.01em}
p strong,td.content strong{letter-spacing:-.005em}
p,blockquote,dt,td.content{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@media print{@page{margin:1.25cm .75cm}
*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare):after,a[href^="https:"]:not(.bare):after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]:after{content:" (" attr(title) ")"}
pre,blockquote,tr,img{page-break-inside:avoid}
thead{display:table-header-group}
img{max-width:100%!important}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
.sect1{padding-bottom:0!important}
.sect1+.sect1{border:0!important}
#header>h1:first-child{margin-top:1.25rem}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em 0}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span:before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]:before{display:block}
#footer{background:none!important;padding:0 .9375em}
#footer-text{color:rgba(0,0,0,.6)!important;font-size:.9em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.2.0/css/font-awesome.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/styles/github.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad()</script>
</head>
<body class="article toc2 toc-right">
<div id="header">
<h1>REST</h1>
<div class="details">
<span id="author" class="author">Architecture</span><br>
<span id="email" class="email"><a href="mailto:arch.se.bcn@scytl.com">arch.se.bcn@scytl.com</a></span><br>
<span id="revnumber">version 1.0,</span>
<span id="revdate">October 22, 2014</span>
<br><span id="revremark">First release</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_json">1. JSON</a>
<ul class="sectlevel2">
<li><a href="#_data_types">1.1. Data types</a></li>
<li><a href="#_example">1.2. Example</a></li>
<li><a href="#_best_practices">1.3. Best Practices</a></li>
</ul>
</li>
<li><a href="#_restful_web_services">2. RESTful Web Services</a>
<ul class="sectlevel2">
<li><a href="#_what_is_rest">2.1. What is REST?</a></li>
<li><a href="#_content_negotiation">2.2. Content Negotiation</a></li>
<li><a href="#versioning-rest">2.3. Versioning</a></li>
<li><a href="#_response_codes">2.4. Response Codes</a>
<ul class="sectlevel3">
<li><a href="#_error_codes">2.4.1. Error Codes</a></li>
</ul>
</li>
<li><a href="#_pagination">2.5. Pagination</a></li>
<li><a href="#_filtering">2.6. Filtering</a></li>
<li><a href="#_field_selection">2.7. Field Selection</a></li>
<li><a href="#_internationalization">2.8. Internationalization</a></li>
<li><a href="#_existence_checks">2.9. Existence checks</a></li>
<li><a href="#_counting">2.10. Counting</a></li>
<li><a href="#_rest_polling">2.11. REST Polling</a></li>
<li><a href="#_chunked_upload">2.12. Chunked Upload</a></li>
<li><a href="#_security">2.13. Security</a>
<ul class="sectlevel3">
<li><a href="#_json_web_token">2.13.1. JSON Web Token</a></li>
<li><a href="#_authentication">2.13.2. Authentication</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_raml">3. RAML</a>
<ul class="sectlevel2">
<li><a href="#_raml_api_designer">3.1. RAML API-Designer</a></li>
</ul>
</li>
<li><a href="#_jax_rs">4. JAX-RS</a>
<ul class="sectlevel2">
<li><a href="#__path">4.1. @Path</a></li>
<li><a href="#_extracting_request_parameters">4.2. Extracting request parameters</a>
<ul class="sectlevel3">
<li><a href="#__queryparam">4.2.1. @QueryParam</a></li>
<li><a href="#__headerparam">4.2.2. @HeaderParam</a></li>
<li><a href="#__cookieparam">4.2.3. @CookieParam</a></li>
</ul>
</li>
<li><a href="#_http_methods">4.3. HTTP methods</a>
<ul class="sectlevel3">
<li><a href="#_creating_a_resource">4.3.1. Creating a resource</a></li>
<li><a href="#_updating_a_resource">4.3.2. Updating a resource</a></li>
<li><a href="#_deleting_a_resource">4.3.3. Deleting a resource</a></li>
</ul>
</li>
<li><a href="#_content_negotiation_2">4.4. Content Negotiation</a></li>
<li><a href="#_errors">4.5. Errors</a>
<ul class="sectlevel3">
<li><a href="#_response">4.5.1. Response</a></li>
<li><a href="#_exceptions">4.5.2. Exceptions</a></li>
</ul>
</li>
<li><a href="#_custom_entity_providers">4.6. Custom Entity Providers</a></li>
<li><a href="#_packaging_and_deployment">4.7. Packaging and Deployment</a>
<ul class="sectlevel3">
<li><a href="#_application">4.7.1. Application</a></li>
<li><a href="#_servlet">4.7.2. Servlet</a></li>
<li><a href="#_default">4.7.3. Default</a></li>
</ul>
</li>
<li><a href="#_testing">4.8. Testing</a>
<ul class="sectlevel3">
<li><a href="#_arquillian_dependencies_and_configuration">4.8.1. Arquillian dependencies and configuration</a></li>
<li><a href="#_arquillian_test">4.8.2. Arquillian Test</a></li>
</ul>
</li>
<li><a href="#_advanced">4.9. Advanced</a>
<ul class="sectlevel3">
<li><a href="#_matrix_params">4.9.1. Matrix Params</a></li>
<li><a href="#_sub_resource_locator">4.9.2. Sub-resource locator</a></li>
<li><a href="#_versioning">4.9.3. Versioning</a></li>
<li><a href="#_patch_and_jax_rs">4.9.4. PATCH and JAX-RS</a></li>
<li><a href="#_chunk_upload">4.9.5. Chunk Upload</a></li>
<li><a href="#_rest_polling_2">4.9.6. REST Polling</a></li>
<li><a href="#_security_2">4.9.7. Security</a>
<ul class="sectlevel4">
<li><a href="#_authentication_2">Authentication</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#_bibliography">Bibliography</a></li>
<li><a href="#_copyright_and_license">Copyright and License</a></li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_json"><a class="anchor" href="#_json"></a>1. JSON</h2>
<div class="sectionbody">
<div class="paragraph">
<p><em>JSON</em> is a the acronym of <strong>JavaScript Object Notation</strong>.
It is used primarly to transmit data between a server and a web application as an alternative to <em>XML</em>.</p>
</div>
<div class="sect2">
<h3 id="_data_types"><a class="anchor" href="#_data_types"></a>1.1. Data types</h3>
<div class="paragraph">
<p><em>JSON&#8217;s</em> basic types are:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Number</dt>
<dd>
<p>Signed decimal number with optional fractional and exponential part.</p>
</dd>
<dt class="hdlist1">String</dt>
<dd>
<p><strong>Unicode</strong> characters.</p>
</dd>
<dt class="hdlist1">Boolean</dt>
<dd>
<p><code>true</code> or <code>false</code>.</p>
</dd>
<dt class="hdlist1">Array</dt>
<dd>
<p>Ordered list of elements in array form.</p>
</dd>
<dt class="hdlist1">Object</dt>
<dd>
<p>Unordered associative array of name/value pairs delimited with curly brackets (&#8216;{&#8217;) and (&#8216;}&#8217;) and each pair separated by colon (&#8216;:&#8217;) character.</p>
</dd>
<dt class="hdlist1">Null</dt>
<dd>
<p><code>null</code>.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_example"><a class="anchor" href="#_example"></a>1.2. Example</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json" data-lang="json">{
    "firstName": "John", <i class="conum" data-value="1"></i><b>(1)</b>
    "lastName": "Smith",
    "isAlive": true, <i class="conum" data-value="2"></i><b>(2)</b>
    "age": 25,
    "heightCm": 167.6, <i class="conum" data-value="3"></i><b>(3)</b>
    "address": { <i class="conum" data-value="4"></i><b>(4)</b>
        "streetAddress": "21 2nd Street",
        "city": "New York",
        "state": "NY",
        "postalCode": "10021-3100"
    },
    "phoneNumbers": [ <i class="conum" data-value="5"></i><b>(5)</b>
        {
            "type": "home",
            "number": "212 555-1234"
        },
        {
            "type": "office",
            "number": "646 555-4567"
        }
    ],
    "favoriteColors": ["blue", "yellow"], <i class="conum" data-value="6"></i><b>(6)</b>
    "spouse": null <i class="conum" data-value="7"></i><b>(7)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Attribute with string value.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Attribute with boolean value. Note that it is not quoted (&#8216;"&#8217;).</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Attribute with decimal value and fraction.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Definition of object with several attributes divided by comma (&#8216;,&#8217;).</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Arrays are defined between brackets (&#8216;[&#8217;) and (&#8216;]&#8217;), and each element separated by comma (&#8216;,&#8217;). Note that an array may contain objects too.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Arrays may contain native types.</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>null attribute value.</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_best_practices"><a class="anchor" href="#_best_practices"></a>1.3. Best Practices</h3>
<div class="ulist">
<ul>
<li>
<p>Indent in <em>JSON</em> documents must be two or four white spaces.</p>
</li>
<li>
<p>Only one key/value pair per line.</p>
</li>
<li>
<p>In case of objects, opening curly bracket should be placed after colon, and closing curly bracket at same idention level as key.</p>
</li>
<li>
<p>In case of arrays of objects, opening bracket should be placed after colon, and closing bracket at same idention level as key.</p>
</li>
<li>
<p>Arrays of simple types may be defined in a single line.</p>
</li>
<li>
<p>Attribute names must follow camel case notation with lowercase first letter.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_restful_web_services"><a class="anchor" href="#_restful_web_services"></a>2. RESTful Web Services</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_what_is_rest"><a class="anchor" href="#_what_is_rest"></a>2.1. What is REST?</h3>
<div class="quoteblock">
<blockquote>
Representational state transfer (REST) is an architectural style consisting of a coordinated set of architectural constraints applied to components, connectors, and data elements, within a distributed hypermedia system
</blockquote>
<div class="attribution">
&#8212; Wikipedia
</div>
</div>
<div class="paragraph">
<p>Web service APIs that follow <em>REST</em> architectural are known as RESTful Web Services.
They defines with these aspects:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a base <em>URI</em> to identify a resource</p>
</li>
<li>
<p>an internet media type like <em>JSON</em>, <em>XML</em>, <em>image</em>.</p>
</li>
<li>
<p>use of standard <em>HTTP</em> methods such as <em>GET</em>, <em>POST</em>, <em>PUT</em> or <em>DELETE</em>.</p>
</li>
<li>
<p>hypertext links to reference state</p>
</li>
<li>
<p>hypertext links to reference related resources</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>RESTful resources are identified by <em>URI</em>.
Depending on the form of the <em>URI</em>, more or less resources will be involved.
Let&#8217;s see some examples of valid <em>URIs</em> and their meaning.</p>
</div>
<table id="valid_uri" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">URI</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/items</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Represents a collection of items</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/items/name/Beer</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Represents  items with name Beer</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/items/ordered</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Represents a collection of items that are ordered</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/users/12/items</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Represents all the items for a user identified with 12</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>As seen in <a href="#valid_uri">previous table</a>, <em>URI</em> only are used to represent resources, but not what action (<em>verb</em>) to apply them.
Actions are set by <em>HTTP</em> methods.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">HTTP methods</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>GET</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Get resource/s</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>POST</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Create a resource</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>PUT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Update a resource if exists or create a new one</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DELETE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Delete a resource</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>HEAD</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HTTP headers are returned without content.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>PATCH</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Apply a <strong>set of changes</strong> to the resource identified by the request&#8217;s <em>URI</em>.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>So the combination of <em>HTTP</em> method and <em>URI</em> sets the operation to be executed and which resources will be affected.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">HTTP method resource URI</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>GET /items</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gets a list of items</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>POST /items</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Create a new item</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>PUT /items/name/Beer</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Updates some data from items with name Beer</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DELETE /users/12/items</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Deletes all items of user with id 12</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>Use nouns to navigate through resources. For example <code>/users/12/items</code> is better than <code>/users/12/getItems</code>.</p>
</li>
<li>
<p>Use subresources to refer to resource associations. For example <code>/users/12/items</code> to get all items from an specific user.</p>
</li>
<li>
<p>Use query params for specific variations and path params only for identifiers. For example <code>/users?age=25</code>.</p>
</li>
<li>
<p>Add defaults for output format for just in case client does not specify it.</p>
</li>
<li>
<p>Use plural nouns. For example use <code>/cars</code> instead of <code>/car</code>.</p>
</li>
<li>
<p><em>JSON</em> document attributes in camel case form.</p>
</li>
<li>
<p>In <em>PUT</em> and <em>POST</em> use body content to send data to be created or updated.</p>
</li>
<li>
<p>By specification <em>PUT</em> is a create or update operation. To avoid confusions <em>PUT</em> should only update resources.</p>
</li>
<li>
<p>Use <em>PATCH</em> to execute a set of operations atomically. <em>PATCH</em> can be used to change a resource partially or apply some operations on it.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">About PATCH</div>
<div class="paragraph">
<p>The <em>PATCH</em> method requests that a set of changes to be applied to resource identified by the request&#8217;s <em>URI</em>.
This set contains instructions describing how a resource currently residing on the origin server should be modified.</p>
</div>
<div class="paragraph">
<p>But <em>PATCH</em> is not about sending an update value rather than the entire resource.</p>
</div>
<div class="paragraph">
<p>Next example is <strong>wrong</strong> and should be avoided:</p>
</div>
<div id="bad-patch" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json" data-lang="json">PATCH /users/123

{ "email": "new.email@example.org" }</code></pre>
</div>
</div>
<div class="paragraph">
<p>As mentioned, <em>PATCH</em> should provide a description of changes to be applied.
You can think about it as a sequence of operations to apply to a resource.</p>
</div>
<div class="paragraph">
<p>RFC-6902 <a href="#rfc6902">[rfc6902]</a> defines a way for expression operations into a <em>JSON</em> document.
Also it defines the 6 possible operations that can be executed:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">test</dt>
<dd>
<p>tests that a value at the target location is equal to a specified value</p>
</dd>
<dt class="hdlist1">remove</dt>
<dd>
<p>removes the value at the target location.</p>
</dd>
<dt class="hdlist1">add</dt>
<dd>
<p>if the target location specifies an array index, a new value is inserted into the array at the specified index. If the target location specifies an object member that does not already exist, a new member is added to the object.</p>
</dd>
<dt class="hdlist1">replace</dt>
<dd>
<p>replaces the value at the target location with a new value.</p>
</dd>
<dt class="hdlist1">move</dt>
<dd>
<p>removes the value at a specified location and adds it to the target location.</p>
</dd>
<dt class="hdlist1">copy</dt>
<dd>
<p>copies the value at a specified location to the target location.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>A possible document may look like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json" data-lang="json">[
  { "op": "test", <i class="conum" data-value="1"></i><b>(1)</b>
    "path": "/a/b/c", <i class="conum" data-value="2"></i><b>(2)</b>
    "value": "foo" <i class="conum" data-value="3"></i><b>(3)</b>
  },
  { "op": "replace", "path": "/a/b/c", "value": 42 }
]</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Operation is set by using <code>op</code> attribute and as value the name of the operation.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><code>path</code> defines where the operation is applied within resource.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td><code>value</code> to apply to given operation.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Previous <a href="#bad-patch">patch example</a> can be rewritten to:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json" data-lang="json">PATCH /users/123 <i class="conum" data-value="1"></i><b>(1)</b>

[
  { "op": "replace", "path": "/email", "value": "new.email@example.org" } <i class="conum" data-value="2"></i><b>(2)</b>
]</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The resource to apply changes is a <em>user</em> with id <em>123</em>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><em>email</em> field of given <em>user</em> is upadated to new <em>value</em>.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can read more examples at <a href="http://tools.ietf.org/html/rfc6902#appendix-A" class="bare">http://tools.ietf.org/html/rfc6902#appendix-A</a></p>
</div>
<div class="paragraph">
<p><em>HTTP</em> 204 status response code is used because the response does not carry any message body.
Of course any other valid <em>HTTP</em> status code could be returned too.</p>
</div>
<div class="paragraph">
<p>Also <em>PATCH</em> requires you set <em>Content-Type</em> header to <code>application/json-patch</code>.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_content_negotiation"><a class="anchor" href="#_content_negotiation"></a>2.2. Content Negotiation</h3>
<div class="paragraph">
<p>RESTful Web Services can consume and produce different media type like <em>JSON</em>, <em>XML</em> or any other valid type like plain text or binary.</p>
</div>
<div class="paragraph">
<p>Content negotiation allows different representations of a resource so that clients can consume what suits best for them.
The de-facto media type in RESTful Web Services is <em>JSON</em>, but client side must provide to server-side which media type is expecting.</p>
</div>
<div class="paragraph">
<p>There are two different approaches:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Using <em>HTTP</em> headers. <code>Accept</code> <em>HTTP</em> header is used by the client to indicate which media type can handle. The <code>Content-Type</code> <em>HTTP</em> header is used to indicate the <em>MIME</em> type of the entity being sent by the server.</p>
</li>
<li>
<p>Using <em>URL</em> patterns. By using extension of the resource, server side knows which media type is expected by the client. For example <code><a href="http://server/items.xml" class="bare">http://server/items.xml</a></code> to retrieve items in <em>XML</em> form.</p>
</li>
</ul>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Use <em>HTTP</em> headers approach instead of <em>URL</em> patterns because <em>HTTP</em> headers provide a clear separation between infrastructure and business.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="versioning-rest"><a class="anchor" href="#versioning-rest"></a>2.3. Versioning</h3>
<div class="paragraph">
<p>Probably RESTful <em>API</em> will evolve during its lifetime.
For this reason we need a way to version the <em>API</em> and provide some kind of back-compatibility so client can choose which version to use.
At least we should ensure that previous applications still works although a new version of the <em>API</em> has been published.
There are several approaches to version <em>APIs</em>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Specifying in the <em>URI</em> itself. For example <code><a href="http://server/v2/items/12" class="bare">http://server/v2/items/12</a></code>. Note that &#8216;v2&#8217; is used as label to set which version of the <em>API</em> client is expecting.</p>
</li>
<li>
<p>Specifying as request parameter. For example <code><a href="http://server/items/12?version=v2" class="bare">http://server/items/12?version=v2</a></code>. Note that in this case version is set as query parameter &#8216;?version=v2&#8217;.</p>
</li>
<li>
<p>Specifying inside <em>HTTP</em> header in <code>Accept</code> field or in a custom one. For example <code>Accept: application/vnd.server.v2+json</code> accepts the content produced in &#8216;json&#8217; and from &#8216;version 2&#8217;.</p>
</li>
</ul>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
There is no clear approach about versioning. We are going to use the first one by setting in <em>URI</em> the version of API.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_response_codes"><a class="anchor" href="#_response_codes"></a>2.4. Response Codes</h3>
<div class="paragraph">
<p>RESTful Web Services use <em>HTTP</em> protocol as communication layer.
An <em>HTTP</em> response must contain a response code so caller can inspect if the request it has done is correct or not.
RESTful Web Services should follow same rules and return a response code depending on the result of executed operation.
Next table summarize typical situations:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33%;">
<col style="width: 33%;">
<col style="width: 33%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Group</th>
<th class="tableblock halign-left valign-top">Code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" rowspan="4"><p class="tableblock">Success 2XX</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>200 OK</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>This returns content as a part of the response</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>201 Created</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Used by <em>POST</em>. It must return <code>Location</code> header with resource id</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>202 Accepted</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Used in asynchronous operations. It must return <code>Location</code> header specifying where the client can monitor for the request.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>204 No Content</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>No content retuned as a part of the response. Used by <em>PUT</em> when the resource is updated succesfully.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" rowspan="2"><p class="tableblock">Redirectional 3XX</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>301 Permanent</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Shows that all requests are directed to new location</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>302 Found</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Shows that a resource already exists and is valid</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" rowspan="7"><p class="tableblock">Client Errors 4XX</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>400 Bad Request</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Used when request cannot be processed due to syntax errors. For example malformed <em>JSON</em>.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>401 Unauthorized</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Used when request cannot be processed because of current user credentials.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>403 Forbidden</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Used when security token is valid but it has expired.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>404 Not Found</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Used when resource is not found, when an unauthenticated user request a secured resource or when security token is missing or invalid.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>406 Not Acceptable</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Used when the resource cannot <strong>produce</strong> the the <em>MIME</em> type specified by the client</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>409 Conflict</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Used when two resources are modified concurrently, in this case the latest modification should not be produced and return this error.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>415 Unsupported Media Type</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Used when the resource cannot <strong>consume</strong> the the <em>MIME</em> type specified by the client</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>422 Unprocessable Entity</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Used when request cannot be processed due to validation errors. Request body is well formed but semantically erroneous. For example an <em>email</em> field without &#8216;@&#8217; character.</p>
</div></div></td>
<td class="tableblock halign-left valign-top" rowspan="2"><p class="tableblock">Server Errors 5XX</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>500 Internal Server error</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Used as a generic error message</p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Most of these codes are provided by default by container so we don&#8217;t have to worry about them.
The most used response codes are &#8216;2XX&#8217;, &#8216;5XX&#8217; and some &#8216;4XX&#8217;.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_error_codes"><a class="anchor" href="#_error_codes"></a>2.4.1. Error Codes</h4>
<div class="paragraph">
<p>In case of error codes, a <em>JSON</em> document can be sent back with information about the failure.
RESTful Web Service uses <em>HTTP</em> error codes to notify them to caller.
Error codes are those starting with &#8216;4XX&#8217; or &#8216;5XX&#8217;.</p>
</div>
<div class="paragraph">
<p>When an error is sent to caller, it can contain a <em>JSON</em> document as response body.
If a <em>JSON</em> document is sent to explain the reason of the failure, it must follow next schema:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json" data-lang="json">{
  "message": "Validation Failed", <i class="conum" data-value="1"></i><b>(1)</b>
  "errors": [ <i class="conum" data-value="2"></i><b>(2)</b>
    {
      "resource": "Book", <i class="conum" data-value="3"></i><b>(3)</b>
      "field": "title", <i class="conum" data-value="4"></i><b>(4)</b>
      "code": "field_mandatory" <i class="conum" data-value="5"></i><b>(5)</b>
    }
  ]
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Generic message explaining the error that has occured. This field is <strong>mandatory</strong>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>List of specific errors. This section is <strong>optional</strong> and it <em>may</em> be used when there are field validation errors. This subdocument has sense when an <em>HTTP 422</em> is sent back.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Name of the resource that contains the error.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Field with the error.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Code that represents the error. Frontend is the responsible of translating this code the user message in the configured locale.</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>There are some discussions about how to notify validation errors. We have based on rfc-4918 <a href="#rfc4918">[rfc4918]</a>, github API <a href="#githubdev">[githubdev]</a> and blog post <a href="#bennadel">[bennadel]</a> which argues that the best option is to use the _HTTP 422 code.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_pagination"><a class="anchor" href="#_pagination"></a>2.5. Pagination</h3>
<div class="paragraph">
<p>REST <em>APIs</em> may return a huge number of resources per request.
To avoid overloading client side (and this is specially a problem in case of lightweight clients), we should paged each request with a certain number of items per request.
This is known as <strong>Response pagination</strong>.
Along with response is important to add some kind of metadata like current page, number of pages, total number of elements or a link to next set of results.</p>
</div>
<div class="paragraph">
<p>There are two possible approaches:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Offset-based pagination which in general uses two query params named <code>offset</code> which sets which page to return and is zero-based and <code>limit</code> that sets the maximum number of results to be returned. For example <code>GET items?page=1&amp;limit=50</code>.</p>
</li>
<li>
<p>Time-based pagination which uses timestamps to paginate results between a specific timeframe. In this case <code>until</code> query param is used to point the end of the time range, and <code>since</code> for the beginning.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In case client can specify which field is used for sorting and direction, <em>sort</em> query param must be used.
As value you set an optional character to set the direction of the order, &#8216;+&#8217; for ascending and &#8216;-&#8217; for descending, and finally the field name to sort.</p>
</div>
<div class="paragraph">
<p>For example <code>GET /books?sort=+name</code> for ascending direction or <code>GET /books?sort=-name</code> for descending.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
If no direction is provided, ascending direction is the default one.
</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Currently you can only sort elements by single field.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Example of Offset-based response</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-json" data-lang="json">{
  "entities": [ <i class="conum" data-value="1"></i><b>(1)</b>
    {
      "name": "foo",
        "age": 20
    },
    {
      "name": "bar",
      "age": 30
    }
  ],

  "pagination": { <i class="conum" data-value="2"></i><b>(2)</b>
    "limit": 100, <i class="conum" data-value="3"></i><b>(3)</b>
    "offset": 0, <i class="conum" data-value="4"></i><b>(4)</b>
    "count": 2, <i class="conum" data-value="5"></i><b>(5)</b>
  },
  "sorting": { <i class="conum" data-value="6"></i><b>(6)</b>
    "orderDirection": "ASC", <i class="conum" data-value="7"></i><b>(7)</b>
    "orderFieldName": "id" <i class="conum" data-value="8"></i><b>(8)</b>
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>entities</code> section adds all elements to be shown in current page.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><code>pagination</code> is the parent element for all pagination elements.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td><code>limit</code> is the number of elements per page to retrieve.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td><code>offset</code> sets the current page (or offset). It is zero-based.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td><code>count</code> is the total number of items available.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td><code>sorting</code> is the parent element for all sort parameters if elements are ordered..</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>Direction of the order. <em>ASC</em> for ascendant and <em>DESC</em> for descendant.</td>
</tr>
<tr>
<td><i class="conum" data-value="8"></i><b>8</b></td>
<td>Ordered field name.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Obviously Time-based pagination is not always possible, it will depend on the resource nature.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Using offset pagination does not avoid returning duplicate records in case where additional resources are added between pagination requests.
This is something that depending on the number of pace of inserts and updates and the criticality of the information shown.</p>
</div>
<div class="paragraph">
<p>To avoid this problem a cursor-based pagination can be used.
Cursor-based pagination is pretty similar to offset approach but uses already known sequencial identifier of entity to know exactly at which point the latest result was returned.</p>
</div>
<div class="paragraph">
<p>You can read about real-time pagination in <a href="#realtimepagination">[realtimepagination]</a>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_filtering"><a class="anchor" href="#_filtering"></a>2.6. Filtering</h3>
<div class="paragraph">
<p>Getting a resource may require some kind of filtering such as returning only resources with specific value.
In this cases query param with field name and value approach is used.</p>
</div>
<div class="paragraph">
<p>For example <code>GET /books?title=Bible</code></p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
You can query by multiple parameters by adding a new query param followed by ampersand (&#8216;&amp;&#8217;)
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_field_selection"><a class="anchor" href="#_field_selection"></a>2.7. Field Selection</h3>
<div class="paragraph">
<p>Sometimes client just need a few attributes instead of all attributes of a resource.
In endpoints that client can choose returned fields, a query param named <em>fields</em> must be used.
And as value a list of comma-separated values of all fields to be returned.</p>
</div>
<div class="paragraph">
<p>For example <code>GET /books?fields=title,pages</code>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
In case of no query param, the whole document should be returned to be compliant with REST <em>API</em>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_internationalization"><a class="anchor" href="#_internationalization"></a>2.8. Internationalization</h3>
<div class="paragraph">
<p>RESTful Web Services can require to serve different responsed depending on the country and the locale.</p>
</div>
<div class="paragraph">
<p>Language negotiation is similar to content negotiation, so you can use diffrent approaches:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Using <code>Accept-Language</code> <em>HTTP</em> headers.</p>
</li>
<li>
<p>Using a query parameter such as <code>locale</code>. For example <code>items/?locale=es</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Use <em>HTTP</em> headers approach instead of query parameter approach because <em>HTTP</em> headers provide a clear separation between infrastructure and business.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Any internacionalized response should set <code>Content-Language</code> <em>HTTP</em> header in response as well.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>In case of ordered <a href="#_pagination">Pagination</a> and internationalization you may want to use <code>java.text.Collator</code> class as a helper class for sorting fields depending on locale.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_existence_checks"><a class="anchor" href="#_existence_checks"></a>2.9. Existence checks</h3>
<div class="paragraph">
<p>From prespective of frontend, sometimes you may need to check the existance of one resource before creating it.
For example to notify the problem to the user as soon as possible while filling a form, instead of after &#8216;submit&#8217; action.</p>
</div>
<div class="paragraph">
<p>As noted at <a href="#headverb">[headverb]</a>, <strong>existence checks</strong> are done by using <em>HEAD</em> <em>HTTP</em> method.</p>
</div>
<div class="quoteblock">
<blockquote>
The HEAD method is identical to GET except that the server MUST NOT return a message-body in the response. The metainformation contained in the HTTP headers in response to a HEAD request SHOULD be identical to the information sent in response to a GET request. This method can be used for obtaining metainformation about the entity implied by the request without transferring the entity-body itself.
</blockquote>
<div class="attribution">
&#8212; RFC - 2616<br>
<cite>Section 9.4</cite>
</div>
</div>
<div class="paragraph">
<p>So in cases where the content is not important, but the existance of the resource is, <em>HEAD</em> is the <em>verb</em> to be used.
We can do everything like a <em>GET</em> and check the response code without the weight of the response body.</p>
</div>
<div class="paragraph">
<p>For example to know if a user with <em>login</em> attribute (which is unique) is already created, next endpoint can be used:</p>
</div>
<div class="paragraph">
<p><code>HEAD <a href="http://&lt;host&gt;/&lt;application&gt;/users?login=johnsmith" class="bare">http://&lt;host&gt;/&lt;application&gt;/users?login=johnsmith</a></code></p>
</div>
<div class="paragraph">
<p>The response may be a <code>200 OK</code> if the resource already exists or <code>404 OK</code> in case it has not been created yet.</p>
</div>
</div>
<div class="sect2">
<h3 id="_counting"><a class="anchor" href="#_counting"></a>2.10. Counting</h3>
<div class="paragraph">
<p>In some cases you may need to count the number of resources that are stored in backend.
In these cases you may use special reserved keyword <code>count</code>.</p>
</div>
<div class="paragraph">
<p>So if we should return the number of books we should do something like <code>GET /books/count</code>.</p>
</div>
<div class="paragraph">
<p>The return type is a <em>JSON</em> document that returns the number of elements.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json" data-lang="json">{
  "count": 6 <i class="conum" data-value="1"></i><b>(1)</b> <i class="conum" data-value="2"></i><b>(2)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>count</code> sets the number of elements.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Number of elements is an integer.</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_rest_polling"><a class="anchor" href="#_rest_polling"></a>2.11. REST Polling</h3>
<div class="paragraph">
<p>Sometimes an action takes too long to be completed in the context of a single <em>HTTP</em> request.
Probably some kind of feedback should be provided to users, for example the number of processed elements, remaining elements or expected time to finish the task.
Asynchronous actions should only executed for <em>POST</em>, <em>PUT</em>, <em>PATCH</em> or <em>DELETE</em> <em>HTTP</em> methods.</p>
</div>
<div class="paragraph">
<p><em>HTTP</em> protocol provides different ways to implement asynchronous callback action:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">WebSockets</dt>
<dd>
<p>It is a protocol providing full-duplex communications channels over a single TCP connection.</p>
</dd>
<dt class="hdlist1">Server Sent Events (SSE)</dt>
<dd>
<p>Browser receives automatic updates from a server via HTTP connection and Server-Sent Events API.</p>
</dd>
<dt class="hdlist1">Polling</dt>
<dd>
<p>The client requests information from the server. Polling cycle is the time in which each element is monitored once.</p>
</dd>
<dt class="hdlist1">Long Polling</dt>
<dd>
<p>The client requests information from the server exactly as in normal polling, but in case of no information, the server side holds the connection until one become available.</p>
</dd>
<dt class="hdlist1">WebHooks</dt>
<dd>
<p>The source site makes an <em>HTTP</em> request to the <em>URI</em> configured for the webhook for given a given event.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>All approaches offer PROs and CONs, but currently the <strong>polling</strong> way is going to be used because of simplification and easier implementation.</p>
</div>
<div class="paragraph">
<p>When an asynchronous operation is executed, instead of returning for example an <em>HTTP 201</em> status code in case of <em>POST</em> or <em>HTTP 204</em> in case of <em>PUT</em>, an <em>HTTP 202</em> code is returned with <code>Location</code> header specifying an identifier of the queued task where the client can monitor the request.
The <em>HTTP 202</em> is returned until defined <em>HTTP</em> status code is returned.
For example an <em>HTTP 201</em> in case of <em>POST</em> or <em>HTTP 204</em> in case of <em>PUT</em>.</p>
</div>
<div class="paragraph">
<p>To get information from a task, <em>GET</em> request should be done to <em>tasks</em> resource and identified with value of <code>Location</code> attribute.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s see an example of REST polling.
Creation of a resource may require validation of external services which can take several seconds.
Some feedback to the users could be provided about what steps are being executed.
To provide this feedback, client is going to use REST polling to know which step is being executed.</p>
</div>
<div class="paragraph">
<p>First step is sending a <em>POST</em> to backend <code>POST <a href="http://&lt;localhost&gt;/&lt;application&gt;/books" class="bare">http://&lt;localhost&gt;/&lt;application&gt;/books</a></code> and it will return a <code>HTTP 202 OK</code> with header&#8217;s attribute <code>Location</code> set to <code>123fa</code>.</p>
</div>
<div class="paragraph">
<p>Then client can send <em>GET</em> requests to <em>tasks</em> resource, in this case <code><a href="http://&lt;localhost&gt;/&lt;application&gt;/tasks/&lt;tokenId&gt" class="bare">http://&lt;localhost&gt;/&lt;application&gt;/tasks/&lt;tokenId&gt</a>;</code>, and polling the resource until a status code not equal to <em>HTTP 202</em> is received.</p>
</div>
<div class="paragraph">
<p>Each time an <em>HTTP 202</em> is returned, a <em>JSON</em> document must be sent in body response with information about the status of the task.
This document may follow next schema:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json" data-lang="json">{
  "processed" : 18, <i class="conum" data-value="1"></i><b>(1)</b>
  "of" : 200, <i class="conum" data-value="2"></i><b>(2)</b>
  "estimatedTime" : 30 <i class="conum" data-value="3"></i><b>(3)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Number of elements that has been processed.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Total number of elements.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Optional parameter that sets the time in seconds remaining until all elements are processed.</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<code>processed</code> and <code>of</code> are integers, but it may contain a null value in case it cannot be calculated.
</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<img src="data:image/png;base64,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" alt="Protocol Schema" width="950" height="546">
</div>
<div class="title">Figure 1. Protocol Schema</div>
</div>
</div>
<div class="sect2">
<h3 id="_chunked_upload"><a class="anchor" href="#_chunked_upload"></a>2.12. Chunked Upload</h3>
<div class="paragraph">
<p>Uploads large files to Dropbox in multiple chunks.
Also has the ability to resume if the upload is interrupted.</p>
</div>
<div class="paragraph">
<p>To implement this massive upload two endpoints are required, <code>/chunkedUpload</code> and <code>/commitChunkedUpload</code>.</p>
</div>
<div class="paragraph">
<p>The typical usage will be:</p>
</div>
<div class="paragraph">
<p>First we send a <code>POST</code> request to <code>/chunkedUpload</code> with the first chunk of bytes of the file.
It will return a <em>JSON</em> document with <code>uploadedId</code> and <code>offset</code> and 202 as <em>HTTP</em> status code.</p>
</div>
<div id="chunked_response" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json" data-lang="json">{
  "uploadId": "5453543AE34348756", <i class="conum" data-value="1"></i><b>(1)</b>
  "offset": 32567 <i class="conum" data-value="2"></i><b>(2)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Sets the number to reference in successive calls.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The byte offset of this chunk relative to the beginning of the full file.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>After that, a successive calls to <code>/chunkedUpload</code> using <code>PUT</code> and passing as parameters both <code>uploadId</code> and <code>offset</code>.
In case of succesful upload a 202 status code is returned and a <em>JSON</em> document like the <a href="#chunked_response">previous one</a> with <code>offset</code> containing the total amount transferred.</p>
</div>
<div class="paragraph">
<p>If <code>uploadId</code> doesn&#8217;t exist then a 404 error code is returned.
If <code>offset</code> parameter is not the one that the server expects, then a 400 error code is returned.</p>
</div>
<div class="paragraph">
<p>To mark that an update has finished we simply need to send a <code>POST</code> to <code>/commitChunkedUpload</code> specifing which upload has been finished using <code>uploadId</code> query parameter, and in body content all metadata information that may be required like name of the file, tags, &#8230;&#8203; and it will return a 201 status code.
In case of <code>uploadId</code> is not found then a 404 error code is returned.</p>
</div>
</div>
<div class="sect2">
<h3 id="_security"><a class="anchor" href="#_security"></a>2.13. Security</h3>
<div class="paragraph">
<p>Security in RESTful Web Services can be implemented in several ways and following different protocols, some of them:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Basic Authentication with TLS</p>
</li>
<li>
<p>OAuth 1.0a</p>
</li>
<li>
<p>OAuth2</p>
</li>
<li>
<p>SAML 2.0</p>
</li>
<li>
<p>&#8220;Tokens Approach&#8221; with <em>JSON</em> Web Token</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Based on previous experience and after studying all of them, &#8220;Tokens Approach&#8221; with <strong>JSON Web Token</strong> is enough.</p>
</div>
<div class="sect3">
<h4 id="_json_web_token"><a class="anchor" href="#_json_web_token"></a>2.13.1. JSON Web Token</h4>
<div class="paragraph">
<p>Instead of supplying credentials such as a username and password with every request, we can allow the client to exchange identification data in a token.</p>
</div>
<div class="paragraph">
<p>The idea behind &#8220;Tokens Approach&#8221; is to generate a signed token with some information and send it with every <em>API</em> call.
Then in server side the token is verified and if it is correct, we can get some parameters from token and use them in authorization mechanism.</p>
</div>
<div class="paragraph">
<p>The initial authentication process is out of scope of <em>JSON</em> Web Token, but in this case login and password are going to be sent .
After that server authenticates the user the token is created and returned to caller with user information like, <em>loginname</em>, <em>name</em> or any parameter about client required by caller with an <em>HTTP</em> 200 code.
Since then the only thing that client and server exchange regarding to authentication is the token.
Token is sent to front and back using the <em>HTTP</em> header attribute <code>x-access-token</code>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="data:image/png;base64,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FBx9+qM+am5/9HnDp9hHluGwjyzePs2rr766c+fOF1988YUXXlDH0Z955pnvaiTi5TlKtX/ta19TsR4XF6cyXX5/kLUhMzxz5sz58+evXbtGXgMAAATlxo0b77zzzunTpwsKCiQft23btnnz5o0bN0qHqQhbu3at3W6XCFu5cmXgQdPw8HD9j5lHRERE+URHR3/uc59Th06X+3z5y19OC7B+/fpRnTiRnZ0t6R84n29+85syf3m4hIQEdYxZWCwWtWzSzbK0skgqneUZpaenf//739+wYYP8/vDzn//8tddeKywsVNGsilm1supjlcVS5ydPnnzzzTdPnTpVWlpaVlYm661cIxlaUVHxP5q33nqrUvO2T5XPn0dDv5c+n0qft3zUI1ZozvjI8pzWyBKWak5pZMlPauSJHNfoKa8XvAp31etydxkbDoejo6Ojt7eXvAYAABiZ2+12uVzq4G51dbVKsTc1eocZI0w/hqofOj2ikR797W9/K5GqDpq+/PLLUuovan7yk5+oXhcbAmRlZekHU4ORkZGRk5Pz7z4yhx/+8Icv+PzsZz/buXOnOk157969v//971/X+B1mVseYVTrLU5PnKM9UdbOKZpXLKpRVFsvK+ctf/lJTUyPFWVtb++6779bV1Z09e/bcuXPnz5+vr6//q+bChQsNmos+jZr3fBzB0adv9FFza/C54PNXH1mG8z6yVGc1spDvamSZ39HUaOS5VGv0jlf5rle7PH25izzutWvXOjs7ZZyQ1wAAACPzeDzd3d1Op/Pq1avSUqrGVIqpCFMd5hdhqsP0Q6f6QVN13LRM43fc1HjoNJDxYGqQjvv4zUo9impl42FmdaRZP8zsl86qm1U0q2JWraz6WGVxU1PT5cuXr1y58v777zc3N8sak19LrmlaW1uvX7/+N01bW1u7psPn7z7O0dDvpc+n3afNRz3idU2rjyxPi0aWsFnzvkaW/LJGnog6t0dPeb3gVbirXpfJZG43btyQESLjhLyeBny0EQCAGcfr9brd7lu3bt28eVNyTaXYFY3eYcYI04+h6odO6zV+B039jpsGHjoNVO0TzIkT+sR+M1HzV4+lH2MOPMysjjGrdJanpj7Pp7pZRbPKZRXKKoulMmUVuVyuzs7ODz74oKur68MPP5T1JunZ09Nz+/btXk1fX98djdvnI81dH09w9Ok/8lFz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t1t16dJFa/A/5inKouv2a9gHWv3HfbBgSkpKoqMTOttY8mrje/TooUsWLlzY5DbbbVevXj18+PCEhARdJzU1tbi4uFnbRl4D5DXIawDt7ymnvr7eetqqUf/q9JAhQ4LFHCYjI0MZes2x67/11lu2yL6hQM29f//+/7iPTZ04cWKTi/Ly8uLi4hSglZWVut/JkydrnZmZmbbUvs/cwvfSpUuq2GeeeabJRbHMEG/atEmXjBw50r4WRyd01n8HZPD6qvbk5GQVvL80+jbbbdXWpaWlOkoLFiywo8rsNUBet31lZWWHDh3atWvXqlWr/uZo6Jg7d+6HAbNmzXr99df/t5lmzpwZXMmcOXM+8ejZxO5r7dq12dnZuvdDztmzZ8lrAO3vKUele88993Tr1q24uFgRqdO6pFlDlbrTTkf5ft0oi+xLEPzJXRW/feuYnY1zgt/x64uyKJaEtS8hKyoq8uenr/ul7rm5uZ06derZs6d/zSa32W7rX7/JD94mrwHy+uZpaGjQr7yGX6vkd955R6X78ssvp6WlaRgcMGDAo48++sADD2j8T0hISEpKus+5//77+/Tp8z/OY489NjzgaY/W8BvntzEbPXr00xGefPLJfv+te/fu9wX80rn33nu1kdqwhx56aIAzePDg1NTUNGfs2LEW8a+99tr777+vfJ83b54l+9atW1XqGpNra2vJawC36ClnzZo1WqThTP9mZWXZhV27dm3s28I0zMXHx/tn/XDU0NzYd9NEWRRcVeQ6bYpatAaNpG+99daZM2eaXNTkazDCaGftOomJicHrL1682L6xrKqqKvZtbvILJslr4GaPdfZXcY8ePVSHgwYNGjhw4LPPPqsIe/HFFy3Cpk2bZnOoCxYssAhbtWpVQUHBTZo0vRkuX76s3+X9+/evXbt2+fLlSudZs2YpLtPT07WzamIdgbvvvltHQ//aoXjiiSe0SI370ksvTZw4cerUqe++++6cOXN02y+//PLrr7/WoLdkyZKlS5dquFi2bJlWu8LR8fnWWelZ5az2/D02/vVXeWxt33r+5lnh0TYs82jz5juffvppRkbGjBkzpk+fbvPor7766u8cRbz2UdX+1FNPWaz36tXLMt2eibTCjRs37t279+TJk+Q1gJuV1xqqtMi+WUbPNFFG85SUFF1n9uzZ/qtHgmnYsryOssj+m3LChAnd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" alt="JSON Web Token" width="970" height="700">
</div>
<div class="title">Figure 2. JSON Web Token</div>
</div>
<div id="jwt_calculation" class="paragraph">
<p>But how is it calculated the token?</p>
</div>
<div class="paragraph">
<p>The <a href="#jsonwebtokenietf">JSON Web Token IETF</a> document defines how token is calculated.
A <em>JWT</em> is split into three parts, separated by periods and each one is encoded separately.
It can be summarized as <code>&lt;base64-encoded header&gt;.&lt;base64-encoded claims&gt;.&lt;base64-encoded signature&gt;</code>.</p>
</div>
<div class="paragraph">
<p>The first part is a <em>JOSE</em> Header.
It is an encoded string representation of a simple <em>JSON</em> document which describes the token along with the hashing algorithm used.</p>
</div>
<div class="listingblock">
<div class="title">JWT using HMAC SHA-256</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-json" data-lang="json">{
  "typ" : "JWT", <i class="conum" data-value="1"></i><b>(1)</b>
  "alg" : "HS256" <i class="conum" data-value="2"></i><b>(2)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Encoded object is a <em>JSON</em> Web Token.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><em>JWT</em> is a <em>JWS</em> MACed using HMAC SHA-256.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The second part of the <em>JWT</em> forms the core of the token.
It is known as <strong>Claims</strong>
It is represented by <em>JSON</em> document too and contains a few pieces of information described in <a href="https://tools.ietf.org/html/draft-ietf-oauth-json-web-token-30#section-4" class="bare">https://tools.ietf.org/html/draft-ietf-oauth-json-web-token-30#section-4</a>.
In next example we can see a simple claim.</p>
</div>
<div class="listingblock">
<div class="title">JWT Claims</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-json" data-lang="json">{
  "iss": "example.com", <i class="conum" data-value="1"></i><b>(1)</b>
  "sub": "john", <i class="conum" data-value="2"></i><b>(2)</b>
  "exp": 1300819380, <i class="conum" data-value="3"></i><b>(3)</b>
  "clientIp": "127.0.0.1" <i class="conum" data-value="4"></i><b>(4)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Identifies the principal that issued the <em>JWT</em>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Identifies the principal that is the subject of the <em>JWT</em>.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Identifies the expiration time on or after which the <em>JWT</em> <strong>must not</strong> be accepted for processing.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>You can also add custom attributes not defined in the spec like <em>clientIp</em>.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The third part of the <em>JWT</em> is a signature generated based on the header (part one) and the body (part two).</p>
</div>
<div class="paragraph">
<p>An example of token may look like: <code>eyJ0eXAiOiJKV1QiLA0KICJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJqb2UiLA0KICJleHAiOjEzMDA4MTkzODAsDQogImh0dHA6Ly9leGFtcGxlLmNvbS9pc19yb290Ijp0cnVlfQ.dBjftJeZ4CVP-mB92K27uhbUJU1p1r_wW1gFWFOEjXk</code>.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p><em>JWT</em> <strong>does not encrypt the payload</strong>, it only signs it.
You should not send any secret information using <em>JWT</em>, rather you should send information that is not secret but needs to be verified.</p>
</div>
<div class="paragraph">
<p>If <em>JWT</em> contains sensitive data you may need to take measures to prevent diclosure of this information to unintended parties.
One way to achieve this is to use an encrypted <em>JWT</em> and authenticate the recipient.
Another way is to ensure that <em>JWTs</em> containing unencrypted privacy-sensitive information are only transmitted using protocols utilizing encryption that support endpoint authentication, such as <em>TLS</em>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>You could add an additional layer of security by storing a record of issued tokens on the server, then verifying them against that record on each subsequent request.
This would prevent a third-party from &#8216;spoofing&#8217; a token, and also allows the server to invalidate a token.</p>
</div>
<div class="paragraph">
<p>Also you can implement rotatory key approach so key used for creating the token change every specified time or requests.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_authentication"><a class="anchor" href="#_authentication"></a>2.13.2. Authentication</h4>
<div class="paragraph">
<p>In <a href="#_json_web_token">JSON Web Token</a> we have only covered the authorization part but not he authentication one.
This section is about <strong>authorization</strong> and how to implement it.</p>
</div>
<div class="paragraph">
<p>Authorization shall be done by sending a <em>JSON</em> document using <em>POST</em> method to <code>/login</code>.
This document contains two attributes <code>username</code> and <code>password</code> and may contain extra attributes like <code>pincode</code>, <code>captcha</code>, &#8230;&#8203;</p>
</div>
<div class="listingblock">
<div class="title">Login Example</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-json" data-lang="json">{
  "username" : "john",
  "password" : "1234"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Because authentication data is considered sensitive, it must be transmitted using <em>TLS</em> as encryption protocol.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Encryption protocol may change depending on requirements of the project.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In case of successful <em>login</em>, an <em>HTTP</em> 200 status code is returned containing a <em>JSON</em> document as response.
This document may contain a <em>JSON</em> object called <code>user</code> with information required by frontend about the user such as <em>full name</em>, <em>date of birth</em> or <em>username</em>.
Also it must contains a <code>token</code> attribute which contains the <em>JSON</em> Web Token calculated as described in <a href="#jwt_calculation">this paragraph</a>.</p>
</div>
<div class="listingblock">
<div class="title">Response Example</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-json" data-lang="json">{
  "user" : {
    "fullName" : "John Smith",
    "username" : "john"
  },

  "token" : "123ACFF234...."
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In case of unsuccessful <em>login</em>, an <em>HTTP</em> 401 status code is returned containing a <em>JSON</em> document as response following <a href="#_error_codes">Error Codes</a> spec.</p>
</div>
<div class="paragraph">
<p>For <strong>logout</strong>, there shall be a <code>/logout</code> endpoint under <em>DELETE</em> method which logouts the user identified by the passed token.
Token is passed as any other request as an <em>HTTP</em> header attribute named <code>x-access-token</code>.
As response an <em>HTTP</em> 204 status code is returned.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_raml"><a class="anchor" href="#_raml"></a>3. RAML</h2>
<div class="sectionbody">
<div class="paragraph">
<p><em>RESTful API</em> Modeling Language <a href="http://raml.org/">RAML</a> is a simple and succinct way of describing practically-RESTful APIs.
It encourages reuse, enables discovery and pattern-sharing, and aims for merit-based emergence of best practices.
The goal is to help our current API ecosystem by solving immediate problems and then encourage ever-better <em>API</em> patterns.
<em>RAML</em> is built on broadly-used standards such as <em>YAML</em> and <em>JSON</em> and is a non-proprietary, vendor-neutral open spec.</p>
</div>
<div class="paragraph">
<p>An example of <em>RAML</em> document may look like:</p>
</div>
<div class="listingblock">
<div class="title">music.raml</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml" data-lang="yaml">#%RAML 0.8 <i class="conum" data-value="1"></i><b>(1)</b>

title: World Music API
baseUri: http://example.api.com/{version}
version: v1
traits: <i class="conum" data-value="2"></i><b>(2)</b>
  - paged:
    queryParameters:
      pages:
        description: The number of pages to return
        type: number
  - secured: !include http://raml-example.com/secured.yml <i class="conum" data-value="3"></i><b>(3)</b>
/songs: <i class="conum" data-value="4"></i><b>(4)</b>
  is: [ paged, secured ]
  get:
    queryParameters:
      genre:
        description: filter the songs by genre
  post:
  /{songId}: <i class="conum" data-value="5"></i><b>(5)</b>
    get:
      responses:
        200:
          body:
            application/json:
              schema: |
                { "$schema": "http://json-schema.org/schema",
                "type": "object",
                "description": "A canonical song",
                "properties": {
                  "title":  { "type": "string" },
                  "artist": { "type": "string" }
                  },
                  "required": [ "title", "artist" ]
                }
  delete:
    description: |
      This method will *delete* an **individual song** <i class="conum" data-value="6"></i><b>(6)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>For every <em>API</em>, start by defining which version of <em>RAML</em> you are using, and then document basic characteristics of your <em>API</em> - the title, version, and baseURI.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><em>RAML</em> allows you to define patterns using traits, resourceTypes, and securitySchemes, and then use them within a <em>API</em> to minimize repetition.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Externalize those patterns, store them on the web, and import them with an !include.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Easily define resources and methods, then add as much detail as you want. Apply traits and other patterns, or add parameters and other details specific to each call.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Describe expected responses for multiple mime-types and specify schemas and examples for each one. Schemas and examples can be defined in-line, or externalized with <code>!include</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Write human-readable, markdown-formatted descriptions throughout your <em>RAML</em> spec, or include entire markdown documentation sections at the root.</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_raml_api_designer"><a class="anchor" href="#_raml_api_designer"></a>3.1. RAML API-Designer</h3>
<div class="paragraph">
<p><em>RAML</em> has a <em>RAML</em> editor that can be installed locally.
The editor and the instructions to install it are found in <a href="https://github.com/Scytl/api-designer" class="bare">https://github.com/Scytl/api-designer</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_jax_rs"><a class="anchor" href="#_jax_rs"></a>4. JAX-RS</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Java API for RESTful Web Services (<em>JAX-RS</em>) is the specification that provides support in creating web services according to the REST architectural pattern.</p>
</div>
<div class="paragraph">
<p>RESTful Web Services are configured by using annotations.
These annotations can be used in <em>POJOs</em> but also in <em>EJBs</em>.
In next examples and for maintaining us container agnostic, we are only going to use <em>JAX-RS</em> specification classes which means they will be portable across containers and <em>JAX_RS</em> implementations.
Also to be focused on REST, we are not going to use <em>EJBs</em> but pure <em>POJOs</em>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">About Apache TomEE</div>
<div class="paragraph">
<p><strong>Apache TomEE</strong> is a <em>Java EE</em> certified web profile application server.
We can summarize as <strong>Apache TomEE = Apache Tomcat + Java EE</strong>.</p>
</div>
<div class="paragraph">
<p><em>RESTful Web Services</em> can be done in Java by using any of <em>JAX-RS</em> implementation like <em>Jersey</em>, <em>Apache CXF</em> or <em>REASTEasy</em>.
Any of this technologies requires a servlet container to run.
All of them can be integrated inside any servlet container like <em>Tomcat</em>, <em>Jetty</em>, &#8230;&#8203; but in these examples we are going to use <strong>Apache TomEE</strong> which it comes with <em>JAX-RS</em> provider integrated.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="__path"><a class="anchor" href="#__path"></a>4.1. @Path</h3>
<div class="paragraph">
<p>@Path is used to define the endpoint <em>URL</em> of RESTful web service.
It can be templatized to pass path parameters from <em>URL</em> path.
Query parameters are not set as <em>URL</em> parameters and in case we need to get query parameters, different annotation must be used.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s see first example of simple RESTful Web Service which gets all books using <code>GET</code> <em>HTTP</em> method.</p>
</div>
<div class="listingblock">
<div class="title">BookResource.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">import javax.ws.rs.GET;
import javax.ws.rs.Path;
import javax.ws.rs.Produces;
import javax.ws.rs.core.MediaType;
import javax.ws.rs.core.Response;

@Path("/books") <i class="conum" data-value="1"></i><b>(1)</b>
public class BookResource {

  @GET <i class="conum" data-value="2"></i><b>(2)</b>
  @Produces(MediaType.APPLICATION_JSON) <i class="conum" data-value="3"></i><b>(3)</b>
  public Response books() {
    List&lt;Book&gt; books = Arrays.asList(new Book("Book1"), new Book("Book2"));
    String json = toJson(books); <i class="conum" data-value="4"></i><b>(4)</b>
    return Response.ok(books).build(); <i class="conum" data-value="5"></i><b>(5)</b>
  }

}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>@Path</code> sets a class as REST endpoint. In this case is bound to <code>/books</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><code>@GET</code> sets which <em>HTTP</em> method is required for executing this method.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Because of content negotiation, the media type must be set. In this case because method does not receive anything, we only need to configure the return type with <code>@Produces</code> annotation.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td><em>Java EE</em> specification does not provide any specific way to convert from/to object to <em>JSON</em>. There is no <em>JSON-B</em> spec. Most providers implements their own system for converting <em>POJOs</em> into required internet type, but you can also converting entities by your own code.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Finally instead of returning a list of books alone, a list of books among with an <em>HTTP</em> 200 code is returned.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Then we can access this resource in <code><a href="http://&lt;host&gt;:&lt;port&gt;/&lt;application&gt;/books" class="bare">http://&lt;host&gt;:&lt;port&gt;/&lt;application&gt;/books</a></code>.</p>
</div>
<div id="JSON-B" class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p><strong>JAVA EE 8</strong> will face the problem of standarizing the <em>JSON Binding</em> problem. Since that point you can use the method provided by <em>JAX-RS</em> provider, or you can implement your own.</p>
</div>
<div class="paragraph">
<p>What <em>JAX-RS</em> specification provides is an standard way to deal with binding by providing a standard interface to be implemented for converting &#8216;string&#8217; content into object and viceversa.
It is important to know exactly which library uses <em>JAX-RS</em> for binding <em>JSON</em>.
If this library fits your requirements, then go ahead with it but keep in mind that you are loosing portability across vendors.
If you want to use another library or you need to maintain portability then use the standard annotations to implement your own method.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>One way to pass parameters to REST endpoints is by specifying <em>URI</em> path parameter.
In previous example there was no parameters so all books were returned.
In next example we are going to pass book id of required book, so instead or returning a list of books, a single book is returned.</p>
</div>
<div class="listingblock">
<div class="title">BookResource</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">@Path("/books")
public class BookResource {

  @GET
  @Path("{bookId}") <i class="conum" data-value="1"></i><b>(1)</b> <i class="conum" data-value="2"></i><b>(2)</b>
  @Produces(MediaType.APPLICATION_JSON)
  public Response book(@PathParam("bookId") String bookId) { <i class="conum" data-value="3"></i><b>(3)</b>

    Book book = findBookById(bookId); <i class="conum" data-value="4"></i><b>(4)</b>

    if(book != null) {
      return Response.ok(book).build();
    } else {
      return Response.status(Status.NOT_FOUND).build(); <i class="conum" data-value="5"></i><b>(5)</b>
    }

  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>@Path</code> annotation can be used in a method as well. It simply adds a new path to the path defined at class level.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><em>URI</em> path templates are variables denoted by curly braces. At runtime this template is substituted by real value.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>To get path template in method <code>@PathParam</code> annotation is used passing the template name.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Value is set to variable and can be used directly without any transformation.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>In case of <em>book</em> not found an <em>HTTP</em> 404 code response is sent back. More information about exception handling in next sections.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>We can access this resource in <code><a href="http://&lt;host&gt;:&lt;port&gt;/&lt;application&gt;/books/123" class="bare">http://&lt;host&gt;:&lt;port&gt;/&lt;application&gt;/books/123</a></code>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Caller can add any <em>URL</em> valid character as path parameter.
In most cases the path parameter will be an integer or a it will contain a well-known pattern.
To protect your endpoints you can set a regular expression on path template.</p>
</div>
<div class="listingblock">
<div class="title">BookResource</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">@Path("/books")
public class BookResource {

  @GET
  @Path("{bookId: [0-9]+}") <i class="conum" data-value="1"></i><b>(1)</b>
  @Produces(MediaType.APPLICATION_JSON)
  public Response book(@PathParam("bookId") String bookId) {

    Book book = findBookById(bookId);

    if(book != null) {
      return Response.ok(book).build();
    } else {
      return Response.status(Status.NOT_FOUND).build();
    }

  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The way to add a regular expression is by adding the name of the path param and the regular expression separated by colon &#8216;:&#8217;.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Resource in <code><a href="http://&lt;host&gt;:&lt;port&gt;/&lt;application&gt;/books/123" class="bare">http://&lt;host&gt;:&lt;port&gt;/&lt;application&gt;/books/123</a></code> will work but <code><a href="http://&lt;host&gt;:&lt;port&gt;/&lt;application&gt;/books/123" class="bare">http://&lt;host&gt;:&lt;port&gt;/&lt;application&gt;/books/123</a></code> returns an <em>HTTP</em> 404 code error.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_extracting_request_parameters"><a class="anchor" href="#_extracting_request_parameters"></a>4.2. Extracting request parameters</h3>
<div class="paragraph">
<p>In &lt;&lt;@Path&gt;&gt; we have seen that we can pass path parameters and extract them using <code>@PathParam</code>.
But there are other ways to send parameters in RESTful Web Services:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">@PathParam</dt>
<dd>
<p>Extracts parameters from <em>URL</em> path.</p>
</dd>
<dt class="hdlist1">@QueryParam</dt>
<dd>
<p>Extracts parameters from query path.</p>
</dd>
<dt class="hdlist1">@FormParam</dt>
<dd>
<p>Extracts parameters from a request of <em>MIME</em> media type <code>application/x-www-form-urlencoded</code>.</p>
</dd>
<dt class="hdlist1">@MatrixParam</dt>
<dd>
<p>Extracts parameters from an <em>HTTP</em> matrix parameters. Matrix parameters are a set of <code>name=value</code> in <em>URL</em> path separated by semicolon &#8216;;&#8217;.</p>
</dd>
<dt class="hdlist1">@HeaderParam</dt>
<dd>
<p>Extracts parameters from <em>HTTP</em> header.</p>
</dd>
<dt class="hdlist1">@CookieParam</dt>
<dd>
<p>Exrtacts parameters from a <em>cookie</em>.</p>
</dd>
</dl>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Avoid using <code>@FormParam</code> because you are tighten endpoint with presentation layer. Also prefer using <code>@QueryParam</code> in front of <code>@MatrixParam</code>.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>All previous ways of extracting parameters from a request (<code>@PathParam</code>, <code>@FormParam</code>, <code>@QueryParam</code> &#8230;&#8203;) can be preceded by <code>@DefaultValue</code> annotation.
This annotation sets the default value in case a parameter is not provided.</p>
</div>
<div class="listingblock">
<div class="title">BookResource</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">@GET
public String books(@DefaultValue("100") @QueryParam("price")int maxResults) {
  return ...;
}</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="__queryparam"><a class="anchor" href="#__queryparam"></a>4.2.1. @QueryParam</h4>
<div class="paragraph">
<p><code>@QueryParam</code> extracts parameters from query path.
Query is an optional part separated from path with a question mark &#8216;?&#8217; and contains pairs of key/value separated by semicolon <code>';'</code>.</p>
</div>
<div class="listingblock">
<div class="title">BookResource</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">@Path("/books")
public class BookResource {

  @GET
  @Produces(MediaType.APPLICATION_JSON)
  public Response books(@QueryParam("orderBy")String field) { <i class="conum" data-value="1"></i><b>(1)</b> <i class="conum" data-value="2"></i><b>(2)</b>
    List&lt;Book&gt; books = findAllBooksOrderedBy(field);
    return Response.ok(books).build();
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>@QueryParam</code> is used in the same way as <code>@PathParam</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>In case of no query param provided, the endpoint is called as well but a <strong>null</strong> value is set in parameter.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>We can access this resource in <code><a href="http://&lt;host&gt;:&lt;port&gt;/&lt;application&gt;/books?orderBy=name" class="bare">http://&lt;host&gt;:&lt;port&gt;/&lt;application&gt;/books?orderBy=name</a></code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="__headerparam"><a class="anchor" href="#__headerparam"></a>4.2.2. @HeaderParam</h4>
<div class="paragraph">
<p><code>@HeaderParam</code> extracts parameters from <em>HTTP</em> header.</p>
</div>
<div class="listingblock">
<div class="title">BookResource</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">@Path("/books")
public class BookResource {

  @GET
  @Produces(MediaType.APPLICATION_JSON)
  public Response books(@HeaderParam("user-agent")String userAgent) {
    //..
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="__cookieparam"><a class="anchor" href="#__cookieparam"></a>4.2.3. @CookieParam</h4>
<div class="paragraph">
<p><code>@CookieParam</code> exrtacts parameters from a <em>cookie</em>.</p>
</div>
<div class="listingblock">
<div class="title">BookResource</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">@Path("/books")
public class BookResource {

  @GET
  @Produces(MediaType.APPLICATION_JSON)
  public Response books(@CookieParam("Last-Accessed")String lastAccessed) {
    //..
  }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_http_methods"><a class="anchor" href="#_http_methods"></a>4.3. HTTP methods</h3>
<div class="paragraph">
<p>In all previous examples <em>GET</em> method has been used as a preferred <em>HTTP</em> method.
But you can use any other <em>HTTP</em> method like <em>POST</em> for creating resources, <em>PUT</em> for updating resources or <em>DELETE</em> for deleteing resources.</p>
</div>
<div class="sect3">
<h4 id="_creating_a_resource"><a class="anchor" href="#_creating_a_resource"></a>4.3.1. Creating a resource</h4>
<div class="paragraph">
<p>To create a resource we must use the <em>POST</em> <em>HTTP</em> method with <code>@POST</code> annotation.</p>
</div>
<div class="listingblock">
<div class="title">BookResource</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">@Path("/books")
public class BookResource {

  @POST <i class="conum" data-value="1"></i><b>(1)</b>
  @Consumes(MediaType.APPLICATION_JSON) <i class="conum" data-value="2"></i><b>(2)</b>
  public Response createBook(String jsonBook) { <i class="conum" data-value="3"></i><b>(3)</b>
    Book book = fromJson(jsonBook); <i class="conum" data-value="4"></i><b>(4)</b>
    book = insertBook(book);

    return Response.created(URI.create("/"+book.getId())).build(); <i class="conum" data-value="5"></i><b>(5)</b>
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>This method is executed when request is of type <em>POST</em>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>This method consumes content instead of producing it. For this reason we must set which media type is consumed by the service.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td><em>JSON</em> payload is set as &#8216;string&#8217;.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>As mentioned in <a href="#JSON-B">JSON section</a> there is no specification about how to bind an object from/to <em>JSON</em>. You can implement your own provider or you can leave this responsability to <em>JAX-RS</em> default provider.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Creation implies to assign an id to a resource. This id must be returned as <em>HTTP</em> header parameter named <code>Location</code> and <em>HTTP</em> 201 status code.</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_updating_a_resource"><a class="anchor" href="#_updating_a_resource"></a>4.3.2. Updating a resource</h4>
<div class="paragraph">
<p>To update a resource we must use the <em>PUT</em> <em>HTTP</em> method with <code>@PUT</code> annotation.</p>
</div>
<div class="listingblock">
<div class="title">BookResource</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">@Path("/books")
public class BookResource {

  @PUT <i class="conum" data-value="1"></i><b>(1)</b>
  @Path("{bookId: [0-9]+}")
  @Consumes(MediaType.APPLICATION_JSON)
  public Response updateBook(@PathParam("bookId") String bookId, String jsonBook) {
    Book book = fromJson(jsonBook);
    book = updateBook(book);

    return Response.noContent().build(); <i class="conum" data-value="2"></i><b>(2)</b>
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>This method is executed when request is of type <em>PUT</em>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>When an update is produced a no content <em>HTTP</em> code should be returned.</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_deleting_a_resource"><a class="anchor" href="#_deleting_a_resource"></a>4.3.3. Deleting a resource</h4>
<div class="paragraph">
<p>To delete a resource we must use the <em>DELETE</em> <em>HTTP</em> method with <code>@DELETE</code> annotation.</p>
</div>
<div class="listingblock">
<div class="title">BookResource</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">@Path("/books")
public class BookResource {

  @DELETE <i class="conum" data-value="1"></i><b>(1)</b>
  @Path("{bookId: [0-9]+}")
  @Consumes(MediaType.APPLICATION_JSON)
  public Response deleteBook(@PathParam("bookId") String bookId) {
    //delete

    return Response.noContent().build(); <i class="conum" data-value="2"></i><b>(2)</b>
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>This method is executed when request is of type <em>DELETE</em>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>When an update is produced a no content <em>HTTP</em> code should be returned.</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_content_negotiation_2"><a class="anchor" href="#_content_negotiation_2"></a>4.4. Content Negotiation</h3>
<div class="paragraph">
<p>RESTful Web Services can consume and produce different media type like <em>JSON</em>, <em>XML</em> or any other valid type like plain text or binary.</p>
</div>
<div class="paragraph">
<p><em>JAX-RS</em> provides <code>@Consumes</code> and <code>@Produces</code> annotations to set which media type are consumed by the service or produced to the client.
In all previous examples <em>application/json</em> media type has been used, but different kind of type can be used as well.
Next list provides a quick overview of the Java types that are supported with respect to media type.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>All media types (*/*)</p>
<div class="ulist">
<ul>
<li>
<p>byte[]</p>
</li>
<li>
<p>java.lang.String</p>
</li>
<li>
<p>java.io.Reader (inbound)</p>
</li>
<li>
<p>java.io.File</p>
</li>
<li>
<p>javax.activation.DataSource</p>
</li>
<li>
<p>javax.ws.rs.core.StreamingOutput (outbound)</p>
</li>
</ul>
</div>
</li>
<li>
<p>XML media types (text/xml, application/xml and application/&#8230;&#8203;+xml)</p>
<div class="ulist">
<ul>
<li>
<p>javax.xml.transform.Source</p>
</li>
<li>
<p>javax.xml.bind.JAXBElement</p>
</li>
<li>
<p>Application supplied JAXB classes (types annotated with @XmlRootElement or@XmlType)</p>
</li>
</ul>
</div>
</li>
<li>
<p>JSON media types (text/json, application/json) <span class="footnote">[<a id="_footnoteref_1" class="footnote" href="#_footnote_1" title="View footnote.">1</a>]</span></p>
<div class="ulist">
<ul>
<li>
<p>javax.xml.transform.Source</p>
</li>
<li>
<p>javax.xml.bind.JAXBElement</p>
</li>
<li>
<p>Application supplied JAXB classes (types annotated with @XmlRootElement or@XmlType)</p>
</li>
</ul>
</div>
</li>
<li>
<p>Form content (application/x-www-form-urlencoded)</p>
<div class="ulist">
<ul>
<li>
<p>MultivaluedMap&lt;String,String&gt;</p>
</li>
</ul>
</div>
</li>
<li>
<p>Plain text (text/plain)</p>
<div class="ulist">
<ul>
<li>
<p>java.lang.Boolean</p>
</li>
<li>
<p>java.lang.Character</p>
</li>
<li>
<p>java.lang.Number</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_errors"><a class="anchor" href="#_errors"></a>4.5. Errors</h3>
<div class="paragraph">
<p>RESTful Web Services can fail because of different situations.
Some of them can be business errors thrown by our process, and others can be errors generated by a third-party library or because of structure problems.</p>
</div>
<div class="sect3">
<h4 id="_response"><a class="anchor" href="#_response"></a>4.5.1. Response</h4>
<div class="paragraph">
<p>Exceptions in <em>JAX-RS</em> are propagated through <em>HTTP</em> response codes as explained in <a href="#_response_codes">Response Codes</a> section.
<em>JAX-RS</em> defines <code>javax.ws.rs.core.Response</code> class to create response code and sent back to the client.</p>
</div>
<div id="response-example" class="listingblock">
<div class="title">BookResource.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">@GET
@Produces(MediaType.APPLICATION_JSON)
public Response book(@PathParam("bookId") String bookId) {

  Book book = findBookById(bookId);

  if (book != null) {
    return Response.ok(book).build();
  } else {
    return Response.status(Status.NOT_FOUND).build(); <i class="conum" data-value="1"></i><b>(1)</b>
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Because element is not found an <em>HTTP</em> 404 error code is thrown to the client.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>That&#8217;s right for almost all cases, but what&#8217;s happening if <code>findBookById</code> instead of returning a null value, it would return an un/checked exception?</p>
</div>
</div>
<div class="sect3">
<h4 id="_exceptions"><a class="anchor" href="#_exceptions"></a>4.5.2. Exceptions</h4>
<div class="paragraph">
<p>Probably the first thing we could do is wrapping code between a <code>try/catch</code> instruction and in catch section add the <code>Response</code> call.</p>
</div>
<div class="paragraph">
<p>But <em>JAX-RS</em> defines <code>javax.ws.rs.ext.ExceptionMapper</code> to map any exception (checked or not) to an <em>HTTP</em> response code.
So if the exception is thrown, transparently to the developer, this exception is transformed to <em>HTTP</em> response code and sent back to client.
This class is automatically discovered byt the <em>JAX-RS</em> runtime during provider scanning phase.</p>
</div>
<div class="listingblock">
<div class="title">PersistenceExceptionMapper.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">import javax.ws.rs.ext.Provider;
import javax.persistence.PersistenceException;

@Provider <i class="conum" data-value="1"></i><b>(1)</b>
public class PersistenceExceptionMapper implements ExceptionMapper&lt;PersistenceException&gt; {

  @Override
  public Response toResponse(PersistenceException exception) { <i class="conum" data-value="2"></i><b>(2)</b>
    return Response.status(Status.INTERNAL_SERVER_ERROR)
          .entity(createErrorMessage(exception.getMessage())).type("application/json").build(); <i class="conum" data-value="3"></i><b>(3)</b>
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Mapper should be annotated with @Provider annotation.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>toResponse method builds the response to be sent back to caller.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Along with <em>HTTP</em> code, a message about the error is also returned following <a href="#_error_codes">error nomenclature</a>.</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_custom_entity_providers"><a class="anchor" href="#_custom_entity_providers"></a>4.6. Custom Entity Providers</h3>
<div class="paragraph">
<p>As we have seen in all previous examples, <em>JAX-RS</em> does not define a way on how to bind an object to its <em>JSON</em> representation and viceversa.
As mentioned this binding can be done by using the one provided by <em>JAX-RS</em> implementation.
For example <em>Apache CXF</em> provides <em>Jettison</em>.
If we choose this approach the application would become not portable across providers, but also we could feel more comfortable with other binder like <em>Gson</em> or <em>Jackson</em>.</p>
</div>
<div class="paragraph">
<p>To make binders portable, <em>JAX-RS</em> defines <code>javax.ws.rs.ext.MessageBodyWrite</code> interface to map an object to <em>JSON</em> and <code>javax.ws.rs.ext.MessageBodyReader</code> to map a <em>JSON</em> document to object.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s see an example of binder which uses <em>Gson</em> as mapper.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">About Gson</div>
<div class="paragraph">
<p><em>Gson</em> is a java library that can be used to convert java objects into their <em>JSON</em> representation.
It can also be used to convert a <em>JSON</em> string to an equivalent java object.
<em>Gson</em> can work with arbitrary java objects including pre-existing objects that you do not have source-code of.</p>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">GsonMessageBodyWriter.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">@Provider <i class="conum" data-value="1"></i><b>(1)</b>
@Produces("application/json") <i class="conum" data-value="2"></i><b>(2)</b>
public class GsonMessageBodyWriter implements MessageBodyWriter&lt;Object&gt; {

  private Gson gson = new Gson();

  @Override
  public long getSize(Object object, Class&lt;?&gt; clazz, Type type, Annotation[] annotations,
      MediaType mediaType) {
    return -1; <i class="conum" data-value="3"></i><b>(3)</b>
  }

  @Override
  public boolean isWriteable(Class&lt;?&gt; clazz, Type type, Annotation[] annotations,
      MediaType mediaType) {
    return true; <i class="conum" data-value="4"></i><b>(4)</b>
  }

  @Override
  public void writeTo(Object object, Class&lt;?&gt; clazz, Type type, Annotation[] annotations,
      MediaType mediaType, MultivaluedMap&lt;String, Object&gt; multivaluedMap,
      OutputStream outputStream) throws IOException {
    String json = gson.toJson(object);
    outputStream.write(json.getBytes()); <i class="conum" data-value="5"></i><b>(5)</b>
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Marks an implementation of an extension interface that should be discoverable by <em>JAX-RS</em> runtime during a provider scanning phase.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>@Produces sets which media type should enable this writer.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>If size of return message cannot be calculated a -1 should be returned.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Sets which kind of objects can be converted using this writer. In this case all of them.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td><em>gson</em> serializes object.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>And inverse operation:</p>
</div>
<div class="listingblock">
<div class="title">GsonMessageBodyReader.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">@Provider
@Consumes("application/json") <i class="conum" data-value="1"></i><b>(1)</b>
public class GsonMessageBodyReader implements MessageBodyReader&lt;Object&gt; {

  private Gson gson = new Gson();

  @Override
  public boolean isReadable(Class&lt;?&gt; clazz, Type type, Annotation[] annotations,
      MediaType mediaType) {
    return true;
  }

  @Override
  public Object readFrom(Class&lt;Object&gt; clazz, Type type, Annotation[] arguments,
      MediaType mediaType, MultivaluedMap&lt;String, String&gt; multivaluedMap,
      InputStream inputStream) throws IOException {
    return gson.fromJson(new InputStreamReader(inputStream), type); <i class="conum" data-value="2"></i><b>(2)</b>
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>@Consumes is used instead of @Produces.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Input stream is converted to required object.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>These class is automatically discovered byt the <em>JAX-RS</em> runtime during provider scanning phase because both of them are annotated with <code>@Provider</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
A single object implementing both interfaces are the common pattern followed in this cases.
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p><em>Jackson</em> mapper has one artifact which implements a <em>JAX-RS</em> provider.
So if you want to use <em>Jackson</em> as mapper you don&#8217;t need to implement it by yourself but just adding a new dependency in your <code>pom.xml</code> file or copying manually the required artifacts into <code>WEB-INF/lib</code>.</p>
</div>
<div class="listingblock">
<div class="title">pom.xml</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;com.fasterxml.jackson.jaxrs&lt;/groupId&gt;
  &lt;artifactId&gt;jackson-jaxrs-json-provider&lt;/artifactId&gt;
  &lt;version&gt;2.4.3&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_packaging_and_deployment"><a class="anchor" href="#_packaging_and_deployment"></a>4.7. Packaging and Deployment</h3>
<div class="paragraph">
<p><em>JAX-RS</em> applications can be packaged and deployed using different three different approaches:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>Application</code> subclass</dt>
<dd>
<p>Use a class that extends <code>javax.ws.rs.core.Application</code> to define the components of a Restful Web Services and provide additional metadata.</p>
</dd>
<dt class="hdlist1"><code>Servlet</code></dt>
<dd>
<p>Update the <code>web.xml</code> deployment descriptor to configure a servlet as dispatcher for RESTful Web Services.</p>
</dd>
<dt class="hdlist1">Default</dt>
<dd>
<p>If you don&#8217;t configure anything, RESTful Web Services are deployed as defined in classes. An scanning classpath fiding resources are done.</p>
</dd>
</dl>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In all our previous examples <strong>Default</strong> method has been used.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_application"><a class="anchor" href="#_application"></a>4.7.1. Application</h4>
<div class="paragraph">
<p>Use a class that extends <code>javax.ws.rs.core.Application</code> to define the components of a Restful Web Services and provide additional metadata.
Metadata may include a common base <em>URI</em> for endopints or for example defining which endpoints should be mapped within specified prefix.</p>
</div>
<div class="paragraph">
<p>In next example <code>BookResource</code> endpoint is going to be registered using <code>javax.ws.rs.core.Application</code>.</p>
</div>
<div class="listingblock">
<div class="title">BookResource.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">@Path("/books")
public class BookResource {
    //....
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">BookApplication.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">import javax.ws.rs.core.Application;
import javax.ws.rs.ApplicationPath;

@ApplicationPath("public") <i class="conum" data-value="1"></i><b>(1)</b>
public class BookApplication extends Application {

  public Set&lt;Class&lt;?&gt;&gt; getClasses() {
    Set&lt;Class&lt;?&gt;&gt; s = new HashSet&lt;Class&lt;?&gt;&gt;();
    s.add(BookApplication.class); <i class="conum" data-value="2"></i><b>(2)</b>
    return s;
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>@ApplicationPath</code> adds a base <em>URI</em> to all components registered inside this application. In this case <em>public</em>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><code>BookResource</code> class is registered within current application.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Now instead of accessing the resource through <code><a href="http://&lt;host&gt;:&lt;port&gt;/&lt;application&gt;/books" class="bare">http://&lt;host&gt;:&lt;port&gt;/&lt;application&gt;/books</a></code>, we need to go to <code><a href="http://&lt;host&gt;:&lt;port&gt;/&lt;application&gt;/public/books" class="bare">http://&lt;host&gt;:&lt;port&gt;/&lt;application&gt;/public/books</a></code>.</p>
</div>
<div class="paragraph">
<p>For simple deployments, no <code>web.xml</code> deployment descriptor is required.
For more complex deployments, for example to secure the Web service or specify initialization parameters, you can package a <code>web.xml</code> deployment descriptor with your application.</p>
</div>
</div>
<div class="sect3">
<h4 id="_servlet"><a class="anchor" href="#_servlet"></a>4.7.2. Servlet</h4>
<div class="paragraph">
<p>By default <code>javax.ws.rs.core.Application</code> classes are self-discovered during classpath scanning phase.
But in case you need to add custom parameters from <code>web.xml</code> to <code>javax.ws.rs.core.Application</code>, the class must be registered within the file.</p>
</div>
<div class="listingblock">
<div class="title">web.xml</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml" data-lang="xml">&lt;web-app&gt;
  &lt;servlet&gt;
    &lt;display-name&gt;BookApplication Servlet&lt;/display-name&gt;
    &lt;servlet-name&gt;BookApplication&lt;/servlet-name&gt;
    &lt;init-param&gt;
      &lt;param-name&gt;javax.ws.rs.Application&lt;/param-name&gt;
      &lt;param-value&gt;myPackage.BookApplication&lt;/param-value&gt;
    &lt;/init-param&gt;
  &lt;/servlet&gt;
  &lt;servlet-mapping&gt;
    &lt;servlet-name&gt;BookApplication&lt;/servlet-name&gt;
    &lt;url-pattern&gt;/*&lt;/url-pattern&gt;
  &lt;/servlet-mapping&gt;
&lt;/web-app&gt;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_default"><a class="anchor" href="#_default"></a>4.7.3. Default</h4>
<div class="paragraph">
<p>By default all resources annotated with <code>@Path</code> or extending <code>javax.ws.rs.Application</code> are auto-discovered when they are at classpath.
This is the default behaviour and the most used.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If application that is being developed contains a single (or two) resources it is not necessary to register them as <code>javax.ws.rs.Application</code>, but on other cases, the best approach is defining them inside it so you can have an overall picture of all REST endpoints.
Most of the times you don&#8217;t need to do anything with <code>web.xml</code> so rely on scanning process.</p>
</div>
<div class="paragraph">
<p>One important point is to put <code>javax.ws.rs.Application</code> in standard place so anyone can take a quick overview of which resources compose our application and their implementatin.
For this reason a common place to put <code>javax.ws.rs.Application</code> class is in <code>rs</code> package.
So a valid package is <code>com.superbiz.app.rs</code>.</p>
</div>
<div class="paragraph">
<p><span class="icon"><i class="fa fa-folder-open-o"></i></span> Credential Manager<br>
&#160;&#160;&#160;&#160;<span class="icon"><i class="fa fa-th-large"></i></span> com.superbiz.app.rs<br>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="icon"><i class="fa fa-file-o"></i></span> CredentialManagerResources.java<br>
&#160;&#160;&#160;&#160;<span class="icon"><i class="fa fa-th-large"></i></span> com.superbiz.app.credential.boundary<br>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="icon"><i class="fa fa-file-o"></i></span> CredentialResource.java<br>
&#160;&#160;&#160;&#160;<span class="icon"><i class="fa fa-th-large"></i></span> com.superbiz.app.credential.entity<br>
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span class="icon"><i class="fa fa-file-o"></i></span> Credential.java<br></p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_testing"><a class="anchor" href="#_testing"></a>4.8. Testing</h3>
<div class="paragraph">
<p>Testing <em>RESTful Web Services</em> can be a bit complicated because there are some logic that are executed by a container.
As we have seen in previous examples you can annotate a class with <code>@Path</code> and this class will become a <em>REST</em> endpoint.
Container is in charge of configuring, registering, and running the endpoint and this is not managed by the developer.</p>
</div>
<div class="paragraph">
<p>The same happens for serializing a returned entity like in <a href="#response-example">this example</a>.
The serialization of an entity is done internally by the container.</p>
</div>
<div class="paragraph">
<p>So running your integration tests requires that you deploy the business code inside the container.
If not you are writing a test that is not exactly running in the same environment as in production and probably you will end up by mocking a lot of container features.</p>
</div>
<div class="paragraph">
<p>And this is exactly what <strong>Arquillian</strong> fixes.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Arquillian</div>
<div class="paragraph">
<p><strong>Arquillian</strong> is a testing framework that fills the gap between unit tests and integration tests so writting integration tests are as simple as writing a unit tests but running them within/against an application server.</p>
</div>
<div class="paragraph">
<p>It deals with all the plumbing of container management, deployment, and framework initialization so you can focus on the task of writing your testsreal tests.
<strong>Arquillian</strong> minimizes the burden on you by covering aspects surrounding test execution; some of these aspects are as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Managing the life cycle of the container (start/stop)</p>
</li>
<li>
<p>Bundling the test class with the dependent classes and resources into a deployable archive</p>
</li>
<li>
<p>Enhancing the test class (for example, resolving @Inject, @EJB, and @Resource injections)</p>
</li>
<li>
<p>Deploying the archive to test applications (deploy/undeploy), and capturing results and failures</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can read more about <em>Arquillian</em> in <a href="#ArquillianHome">[ArquillianHome]</a>.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>So let&#8217;s start by adding <em>Arquillian</em> dependencies.</p>
</div>
<div class="sect3">
<h4 id="_arquillian_dependencies_and_configuration"><a class="anchor" href="#_arquillian_dependencies_and_configuration"></a>4.8.1. Arquillian dependencies and configuration</h4>
<div id="arquillian-pom" class="listingblock">
<div class="title">pom.xml</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml" data-lang="xml">&lt;dependencyManagement&gt;
  &lt;dependencies&gt;
    &lt;dependency&gt;
    &lt;groupId&gt;org.jboss.arquillian&lt;/groupId&gt; <i class="conum" data-value="1"></i><b>(1)</b>
    &lt;artifactId&gt;arquillian-bom&lt;/artifactId&gt;
    &lt;version&gt;1.1.7.Final&lt;/version&gt;
    &lt;scope&gt;import&lt;/scope&gt;
    &lt;type&gt;pom&lt;/type&gt;
    &lt;/dependency&gt;
  &lt;/dependencies&gt;
&lt;/dependencyManagement&gt;

&lt;dependencies&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;org.apache.openejb&lt;/groupId&gt; <i class="conum" data-value="2"></i><b>(2)</b>
    &lt;artifactId&gt;arquillian-tomee-embedded&lt;/artifactId&gt;
    &lt;version&gt;1.7.1&lt;/version&gt;
    &lt;scope&gt;test&lt;/scope&gt;
  &lt;/dependency&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;org.apache.openejb&lt;/groupId&gt; <i class="conum" data-value="3"></i><b>(3)</b>
    &lt;artifactId&gt;tomee-jaxrs&lt;/artifactId&gt;
    &lt;version&gt;1.7.1&lt;/version&gt;
    &lt;scope&gt;test&lt;/scope&gt;
  &lt;/dependency&gt;
&lt;/dependencies&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Adds <em>Arquillian</em> <code>bom</code> file. This makes that all component added as dependency will contain exactly the same version.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Because we are using <em>Apache TomEE</em>, this dependency adds <em>Apache TomEE</em> as container to be managed by <em>Arquillian</em>.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Embedded <em>Apache TomEE</em> doesn&#8217;t comes with <em>JAX-RS</em> libraries so we need to add them manually.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Let&#8217;s see how an Arquillian test looks like:</p>
</div>
</div>
<div class="sect3">
<h4 id="_arquillian_test"><a class="anchor" href="#_arquillian_test"></a>4.8.2. Arquillian Test</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">@RunWith(Arquillian.class) <i class="conum" data-value="1"></i><b>(1)</b>
public class MoviesServiceTest {

  @Deployment <i class="conum" data-value="2"></i><b>(2)</b>
  public static JavaArchive createDeploymentPackage() {
    return createDeploymentFile();
  }

  @EJB <i class="conum" data-value="3"></i><b>(3)</b>
  MoviesService moviesService;

  @Test
  public void shouldCreateMovies() {
    <i class="conum" data-value="4"></i><b>(4)</b>
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Test must use <code>Arquillian</code> runner.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><em>Arquillian</em> needs to know what to deploy on the started container. Deployment file is created in an <code>static</code> method annotated with <code>Deployment</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>By default <em>Arquillian</em> runs tests inside the container so we can use any <em>Java EE</em> annotation available inside the container. In this case <code>javax.ejb.EJB</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>The test itself using the <em>EJB</em> or whatever we want.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>As you may see test looks pretty similar to a unit test, a lot of details about application server or some aspects on how is started and stopped the application server are hidden to the developers.
So what is happening under the covers when previous test is executed?</p>
</div>
<div class="imageblock">
<div class="content">
<img src="data:image/png;base64,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" alt="Arquillian Lifecycle" width="670" height="476">
</div>
<div class="title">Figure 3. Arquillian Lifecycle</div>
</div>
<div class="paragraph">
<p>First of all <em>Arquillian</em> starts an embedded <em>Apache TomEE</em> (we have defined this in <a href="#arquillian-pom">pom.xml</a> in section 2).
Then a method annotated with <code>Deployment</code> annotation is called and returns a <code>JavaArchive</code> to be deployed.</p>
</div>
<div class="paragraph">
<p>After that the generated deployment file and the test itself is packaged and deployed to <em>Apache TomEE</em>.
The test is run inside the container and the results are sent back to IDE.
Note that this step is required because tests are run inside the container, and the result should be notified to the caller (surefire plugin, IDE, &#8230;&#8203;).</p>
</div>
<div class="paragraph">
<p>And finally if there is no more tests to execute container is cleaned from deployed artifacts and <em>Apache TomEE</em> is stopped.</p>
</div>
<div class="paragraph">
<p>And how should looks like a <code>@Deployment</code> annotated method?
To create a deployment file you need to use a project called <code>Shrinkwrap</code>.
<em>Arquillian</em> has already this project as dependency so you don&#8217;t need to worry about including it in <code>pom.xml</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">@Deployment
public static WebArchive createDeploymentPackage() {
  WebArchive deploymentFile = ShrinkWrap.create(WebArchive.class) <i class="conum" data-value="1"></i><b>(1)</b>
  .addPackage("com.scytl.hibernate") <i class="conum" data-value="2"></i><b>(2)</b>
  .addAsWebInfResource(EmptyAsset.INSTANCE, "beans.xml") <i class="conum" data-value="3"></i><b>(3)</b>
  return deploymentFile;
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Creates a <code>war</code> file in memory. You could create an <code>ear</code> or <code>jar</code> file as well.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Adds inside the <code>war</code> file all classes under the package <code>com.scytl.hibernate</code>. That is inside a virtual directory called <code>WEB-INF/classes</code> as <code>war</code> spec suggests.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Adds an empty file called <code>beans.xml</code> as <code>WEB-INF</code> resource. That is in <code>WEB-INF</code> directory.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>And with this virtual object file <em>Arquillian</em> manages itself to deploy it to container.</p>
</div>
<div class="paragraph">
<p>By default <em>Arquillian</em> runs tests inside the container.
This is known as <strong>in-container</strong> mode because <em>Arquillian</em> will package the deployment file along with test and sent it to the container for execution.</p>
</div>
<div class="paragraph">
<p>But there is also another mode called <strong>client</strong>.
In this case <em>Arquillian</em> will simply deploy the deplpoyment file to the server but the test will remain on client side (running from your JVM).
In these cases you are free to test the container from the outside, as any client (for example browser) will see it.
So for testing <em>JAX-RS</em> applications it may be really useful using <em>client</em> mode instead of <em>in-container</em> ones.</p>
</div>
<div class="paragraph">
<p>The <em>Arquillian</em> lifecycle in <em>client</em> mode looks like:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="data:image/png;base64,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" alt="Arquillian container Lifecycle" width="610" height="476">
</div>
<div class="title">Figure 4. Arquillian container Lifecycle</div>
</div>
<div class="paragraph">
<p>Note that now the deployment file is deployed (but not the test) and instead of running test inside container, test is run inside the client and it communicates with container as any other client would do, by using a <em>URL</em>.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s see an example on how to use <em>client</em> mode with RESTful Web Services.</p>
</div>
<div class="listingblock">
<div class="title">com/scytl/rest/PersonResource.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">package com.scytl.rest;


import javax.ws.rs.GET;
import javax.ws.rs.Path;
import javax.ws.rs.PathParam;
import javax.ws.rs.Produces;
import javax.ws.rs.core.MediaType;
import javax.ws.rs.core.Response;

@Path("/person") <i class="conum" data-value="1"></i><b>(1)</b>
public class PersonResource {

  private String OUTPUT = "{\n" +
  "  \"firstName\": \"John\",\n" +
  "  \"lastName\": \"Smith\",\n" +
  "  \"isAlive\": true,\n" +
  "  \"age\": 25,\n" +
  "  \"height_cm\": 167.6,\n" +
  "  \"address\": {\n" +
  "    \"streetAddress\": \"21 2nd Street\",\n" +
  "    \"city\": \"New York\",\n" +
  "    \"state\": \"NY\",\n" +
  "    \"postalCode\": \"10021-3100\"\n" +
  "  },\n" +
  "  \"phoneNumbers\": [\n" +
  "    {\n" +
  "      \"type\": \"home\",\n" +
  "      \"number\": \"212 555-1234\"\n" +
  "    },\n" +
  "    {\n" +
  "      \"type\": \"office\",\n" +
  "      \"number\": \"646 555-4567\"\n" +
  "    }\n" +
  "  ],\n" +
  "  \"children\": [],\n" +
  "  \"spouse\": null\n" +
  "}";

  @GET
  @Path("{personId}")
  @Produces(MediaType.APPLICATION_JSON)
  public Response person(@PathParam("personId") String bookId) {
    return Response.ok(OUTPUT).build(); <i class="conum" data-value="2"></i><b>(2)</b>
  }

}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Common <em>JAX-RS</em> annotations are used in the example.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Service returns a <em>JSON</em> document.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>So now we need to write a test.
It will use <em>Arquillian</em> to deploy the <code>PersonResource</code> inside container and then use <code>Rest-Assured</code> for connecting to the service and assert the output message.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">About REST-Assured</div>
<div class="paragraph">
<p>Testing and validating <em>REST</em> services in Java is harder than in dynamic languages such as <em>Ruby</em> and <em>Groovy</em>.
<strong>REST Assured</strong> brings the simplicity of using these languages into the Java domain.</p>
</div>
<div class="paragraph">
<p>More examples of how to use it can be found at <a href="https://code.google.com/p/rest-assured/wiki/Usage" class="bare">https://code.google.com/p/rest-assured/wiki/Usage</a>.</p>
</div>
<div class="paragraph">
<p>Only one dependency is required to use <em>REST-assured</em> in a project.</p>
</div>
<div class="listingblock">
<div class="title">pom.xml</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;com.jayway.restassured&lt;/groupId&gt;
  &lt;artifactId&gt;rest-assured&lt;/artifactId&gt;
  &lt;version&gt;2.4.0&lt;/version&gt;
  &lt;scope&gt;test&lt;/scope&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="listingblock">
<div class="title">com/scytl/rest/PersonResourceTest.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">package com.scytl.rest;

import static com.jayway.restassured.RestAssured.get;
import static org.junit.Assert.assertThat;
import static org.hamcrest.CoreMatchers.is;


import com.jayway.restassured.path.json.JsonPath;
import org.jboss.arquillian.container.test.api.Deployment;
import org.jboss.arquillian.junit.Arquillian;
import org.jboss.arquillian.test.api.ArquillianResource;
import org.jboss.shrinkwrap.api.ShrinkWrap;
import org.jboss.shrinkwrap.api.spec.WebArchive;
import org.junit.Test;
import org.junit.runner.RunWith;

import javax.ws.rs.core.UriBuilder;
import java.io.InputStream;
import java.net.URI;
import java.net.URL;

@RunWith(Arquillian.class) <i class="conum" data-value="1"></i><b>(1)</b>
public class PersonResourceTest {

  @Deployment(testable = false) <i class="conum" data-value="2"></i><b>(2)</b>
  public static WebArchive createDeployment() {
    return ShrinkWrap.create(WebArchive.class, "persontest.war")
    .addClass(PersonResource.class);
  }

  @ArquillianResource <i class="conum" data-value="3"></i><b>(3)</b>
  URL baseUrl;

  @Test
  public void shouldReturnExpectedPerson() {
    URI endpoint = UriBuilder.fromPath(baseUrl.toExternalForm()).path(PersonResource.class).path("1").build(); <i class="conum" data-value="4"></i><b>(4)</b>
    InputStream response = get(endpoint).then().statusCode(200).extract().asInputStream(); <i class="conum" data-value="5"></i><b>(5)</b>

    JsonPath jsonPath = new JsonPath(response);
    String firstName = jsonPath.getString("firstName"); <i class="conum" data-value="6"></i><b>(6)</b>
    String streetAddress = jsonPath.getString("address.streetAddress"); <i class="conum" data-value="7"></i><b>(7)</b>

    assertThat(firstName, is("John"));
    assertThat(streetAddress, is("21 2nd Street")); <i class="conum" data-value="8"></i><b>(8)</b>
  }

}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Tests should be annotated with <code>Arquillian</code> runner.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Sets test to be run in container by using <code>testeable = false</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The deployed file is deployed in a server. Using <code>@ArquillianResource</code> the URL where the file is deployed is injected on test.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Creates the <em>URI</em> where endpoint is mapped.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Uses <code>get</code> static method (provided by REST-assured) to do an invocation using <code>HTTP GET</code> to procided direction and asserts that the status code is the expected one.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td><code>JsonPath</code> class allows you to use <em>XPath</em> like expressions but for <em>JSON</em>.</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td><code>streetAddress</code> value is got from returned <em>JSON</em> document.</td>
</tr>
<tr>
<td><i class="conum" data-value="8"></i><b>8</b></td>
<td>Standard <code>assertThat</code> method from <em>JUnit</em> is used.</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_advanced"><a class="anchor" href="#_advanced"></a>4.9. Advanced</h3>
<div class="sect3">
<h4 id="_matrix_params"><a class="anchor" href="#_matrix_params"></a>4.9.1. Matrix Params</h4>

</div>
<div class="sect3">
<h4 id="_sub_resource_locator"><a class="anchor" href="#_sub_resource_locator"></a>4.9.2. Sub-resource locator</h4>
<div class="paragraph">
<p>Resource classes can partially process a request and then provide another sub-resource object to process the remainder of the request.
This approach can be used in different situations, but one situation that fits pretty well is to deal with &#8220;M to 1&#8221; relationships.</p>
</div>
<div class="paragraph">
<p>Resource methods with a <code>@Path</code> annotation and no <em>HTTP</em> method are considered sub-resource locators and they provide an object that can process the request.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s see an example.
In previous examples we have worked with <em>Book</em> entity which can be something like:</p>
</div>
<div class="listingblock">
<div class="title">Book.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">public class Book {

  private long id;
  private String title;

  public Book(long id, String title) {
    this.title = title;
    this.id = id;
  }

  public String getTitle() {return title;}
  public int getId() {return 1;}
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>And when <code>GET /book/12</code> is executed, the <em>book</em> with <em>id</em> 12 is returned.</p>
</div>
<div class="paragraph">
<p>But let&#8217;s add a <em>Chapter</em> entity and how it is related with <em>Book</em>.</p>
</div>
<div class="listingblock">
<div class="title">Chapter.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">public class Chapter {

  private long id;
  private String title;
  private String content;

  private Book book;

  public Chapter(long id, String title, String content, Book book) {
    this.id = id;
    this.title = title;
    this.content = content;
    this.book = book;
  }

  public long getId() { return id; }
  public String getTitle() { return title; }
  public String getContent() { return content; }
  public Book getBook() { return book; }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>One book contains one or more chapters.
So new <em>book</em> entity should be modified to:</p>
</div>
<div class="listingblock">
<div class="title">Book.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">public class Book {

  private long id;
  private String title;

  private List&lt;Chapter&gt; chapters = new ArrayList&lt;Chapter&gt;();

  public Book(long id, String title) {
    this.title = title;
    this.id = id;
  }

  public void addChapter(Chapter chapter) { this.chapters.add(chapter); }
  public List&lt;Chapter&gt; getChapters() { return chapters; }
  public String getTitle() { return title; }
  public long getId() { return id; }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>To return all <em>chapters</em> of given <em>book</em>, you can do something like:</p>
</div>
<div class="listingblock">
<div class="title">BookResource.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">@Path("/books")
public class BookResource {

  @GET
  @Path("{bookId: [0-9]+}/chapters")
  @Produces(MediaType.APPLICATION_JSON)
  public Response chapters(@PathParam("bookId")Long bookId) {
    Book book = findBookById(bookId);
    return Response.ok(book.getChapters()).build(); <i class="conum" data-value="1"></i><b>(1)</b>

}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>List of chapters are returned from <code>BookResource</code> class.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>We can access this resource in <code><a href="http://&lt;host&gt;:&lt;port&gt;/&lt;application&gt;/books/123/chapters" class="bare">http://&lt;host&gt;:&lt;port&gt;/&lt;application&gt;/books/123/chapters</a></code> and the list of chapters will be returned.</p>
</div>
<div class="paragraph">
<p>No secret here and no <strong>sub resources</strong> involved yet.
But note that we are mixing <em>books</em> with <em>chapters</em> in same endpoint.
It is better to maintain classes as simple as possible, and more important doing the work they were designed for, in case of <code>BookResource</code> it is dealing with books and not chapters.</p>
</div>
<div class="paragraph">
<p>So one way is make <code>Book</code> as <strong>sub resource</strong>.
Thanks of subresources, all RESTful endpoint matching releated with returning a list of chapters will be delegated to <code>Book</code> itself.
Because <code>Book</code> is responsible of knowing that it contains a list of chapters, it should be the responsible of returning them as well.
Let&#8217;s see how to do it in <em>JAX-RS</em>.</p>
</div>
<div class="paragraph">
<p>First thing to do is set that <code>chapters</code> method from <code>BookResource</code> returns a subresource instead of a resource.
This is accomplished by removing <em>HTTP</em> method annotation.</p>
</div>
<div class="listingblock">
<div class="title">BookResource.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">@Path("/books")
public class BookResource {

  @Path("{bookId: [0-9]+}") <i class="conum" data-value="1"></i><b>(1)</b> <i class="conum" data-value="2"></i><b>(2)</b>
  public Book chapters(@PathParam("bookId")Long bookId) {

    Book book = findBookById(bookId);
    return book; <i class="conum" data-value="3"></i><b>(3)</b>
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Only path realated with book is set.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>No <em>HTTP</em> method annotation is present.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Finally we return the subresource.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>And next step is define that <code>Book</code> is a subresource and must contains the path part not set in <code>BookResource</code>.</p>
</div>
<div class="listingblock">
<div class="title">Book.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">public class Book {

  private long id;
  private String title;

  private List&lt;Chapter&gt; chapters = new ArrayList&lt;Chapter&gt;();

  public Book() {
  }

  public Book(long id, String title) {
    this.title = title;
    this.id = id;
  }

  public void addChapter(Chapter chapter) {
    this.chapters.add(chapter);
  }

  @GET <i class="conum" data-value="1"></i><b>(1)</b>
  @Produces(MediaType.APPLICATION_JSON)
  @Path("/chapters") <i class="conum" data-value="2"></i><b>(2)</b>
  public List&lt;Chapter&gt; getChapters() {
    return chapters; <i class="conum" data-value="3"></i><b>(3)</b>
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><em>HTTP</em> method is set so this method returns a full resource.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><code>@Path</code> sets the subresource path.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Returns a list of all chapters.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>We can access this resource in <code><a href="http://&lt;host&gt;:&lt;port&gt;/&lt;application&gt;/books/123/chapters" class="bare">http://&lt;host&gt;:&lt;port&gt;/&lt;application&gt;/books/123/chapters</a></code> and the list of chapters will be returned.
But now the code will do next steps.
First of all it will run <code><a href="http://&lt;host&gt;:&lt;port&gt;/&lt;application&gt;/books/123" class="bare">http://&lt;host&gt;:&lt;port&gt;/&lt;application&gt;/books/123</a></code> in <code>BookResource</code>.
Because it returns a subresource, the engine will continue inspecting the part not processed of the <em>URI</em>, in this case <code>/chapters</code>, through returned subresource.
So it will find that <code>Book</code> class contains a method annotated with <code>@Path("/chapters")</code>, and because it matches, the method will be executed by returning a list of chapters.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
You can use the same approach to return single attribute in case client needs to access them from your <em>REST</em> API, for example <code>/books/title</code>.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>In this example the entity class has been used as subresource.
But if you want to maintain your entity classes anemic, you can create a subresource class such as <code>BookSubresource</code> that wraps <code>Book</code>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_versioning"><a class="anchor" href="#_versioning"></a>4.9.3. Versioning</h4>
<div class="paragraph">
<p>As seen in <a href="#versioning-rest">REST versioning</a>, RESTful Web Services are going to be versioned (in case it is necessary) using <em>URL</em> path to set version number of <em>API</em>.</p>
</div>
<div class="paragraph">
<p>Versioning can be implemented following different approaches, but using <a href="#_application">Application</a> may be cleaner way to implement it.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s suppose we have different resources and we want to give support to two different versions &#8216;v1&#8217; and &#8216;v2&#8217;.
The first thing to do is create two applications, one for each version.</p>
</div>
<div class="listingblock">
<div class="title">V1Application.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">@ApplicationPath("/v1") <i class="conum" data-value="1"></i><b>(1)</b>
public class V1Application {

  @Override
  public Set&lt;Class&lt;?&gt;&gt; getClasses() {
    Set&lt;Class&lt;?&gt;&gt; s = new HashSet&lt;Class&lt;?&gt;&gt;();
    s.add(ChapterResourceV1.class); <i class="conum" data-value="2"></i><b>(2)</b> <i class="conum" data-value="3"></i><b>(3)</b>
    return s;
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Version 1 is identified as &#8216;v1&#8217; in <em>URL</em>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>It registers the <em>Chapter</em> resource that contains the implementation of version 1.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>And the same for all resources available in version 1 of the <em>API</em>.</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">ChapterResourceV1.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">public class ChapterResourceV1 {

  @GET
  @Path("/") <i class="conum" data-value="1"></i><b>(1)</b>
  @Produces(MediaType.APPLICATION_JSON)
  public Chapter chapter() {
    return ...;
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>And then a second version of the <em>API</em> is developed.
What we need to do is create a new application for version 2.</p>
</div>
<div class="listingblock">
<div class="title">V2Application.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">@ApplicationPath("/v2") <i class="conum" data-value="1"></i><b>(1)</b>
public class V2Application {

  @Override
  public Set&lt;Class&lt;?&gt;&gt; getClasses() {
    Set&lt;Class&lt;?&gt;&gt; s = new HashSet&lt;Class&lt;?&gt;&gt;();
    s.add(ChapterResourceV2.class);
    return s;
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Version 2 is identified as &#8216;v2&#8217; in <em>URL</em>.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>We can access this resource in <code><a href="http://&lt;host&gt;:&lt;port&gt;/&lt;application&gt;/v1/chapter" class="bare">http://&lt;host&gt;:&lt;port&gt;/&lt;application&gt;/v1/chapter</a></code> and the list of chapters will be returned using &#8216;v1&#8217; resource.
Accessing <code><a href="http://&lt;host&gt;:&lt;port&gt;/&lt;application&gt;/v2/chapter" class="bare">http://&lt;host&gt;:&lt;port&gt;/&lt;application&gt;/v2/chapter</a></code> the list of chapters will be returned as wel but using &#8216;v2&#8217; resource instead.</p>
</div>
</div>
<div class="sect3">
<h4 id="_patch_and_jax_rs"><a class="anchor" href="#_patch_and_jax_rs"></a>4.9.4. PATCH and JAX-RS</h4>
<div class="paragraph">
<p>Current version of <em>JAX-RS</em> (v2.0) does not implement <em>PATCH</em> <em>HTTP</em> method.
But <em>JAX-RS</em> allows developers to implement their own methods, so in this case we could implement by ourselves the <em>PATCH</em> one.</p>
</div>
<div class="listingblock">
<div class="title">PATCH.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">@Target({ElementType.METHOD})
@Retention(RetentionPolicy.RUNTIME)
@HttpMethod("PATCH") <i class="conum" data-value="1"></i><b>(1)</b>
public @interface PATCH {

}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>To implement an <em>HTTP</em> mehtod, <code>HttpMethod</code> must be used.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>And <code>PATH</code> can be used without any problem as <code>GET</code>, <code>POST</code>, &#8230;&#8203;</p>
</div>
<div class="listingblock">
<div class="title">BookResource.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">@PATCH <i class="conum" data-value="1"></i><b>(1)</b>
@Consumes("application/json-patch") <i class="conum" data-value="2"></i><b>(2)</b>
public Response patch(JsonArray jsonObject) { <i class="conum" data-value="3"></i><b>(3)</b>

  //...

  return Response.noContent().build();
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>PATCH</code> annotation is used without any problem.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><code>Content-Type</code> for Patch operation should be <code>application/json-patch</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Patch content is an array of operations to be executed.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>We can access this resource in <code><a href="http://&lt;host&gt;:&lt;port&gt;/&lt;application&gt;/book" class="bare">http://&lt;host&gt;:&lt;port&gt;/&lt;application&gt;/book</a></code> with <em>HTTP</em> method <em>PATCH</em> and <code>Content-Type</code> as <code>application/json-patch</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_chunk_upload"><a class="anchor" href="#_chunk_upload"></a>4.9.5. Chunk Upload</h4>
<div class="paragraph">
<p>In <a href="#_chunked_upload">Chunked Upload</a> we described how implement an upload of a huge chunked bytes in <em>REST</em>.</p>
</div>
<div class="listingblock">
<div class="title">Initial upload</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">@Inject
TemporaryFolder temporaryFolder;

@POST
@Path("/chunkedUpload")
@Consumes("*/*")
@Produces(MediaType.APPLICATION_JSON)
public Response chunked(InputStream reader) throws IOException {
  UUID uploadId = UUID.randomUUID(); <i class="conum" data-value="1"></i><b>(1)</b>

  java.nio.file.Path file = temporaryFolder.newFile(uploadId.toString()); <i class="conum" data-value="2"></i><b>(2)</b>
  long offset = IOUtil.copyToFile(file, reader, Integer.MAX_VALUE); <i class="conum" data-value="3"></i><b>(3)</b>
  return Response
    .status(202)
    .entity("{\n" + "  \"uploadId\": \"" + uploadId + "\",\n"
      + "  \"offset\": " + offset + "\n" + "}").build();
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Generates a random number as <code>uploadId</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Creates a new file using the generated <em>UUID</em> in a temporal directory.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Copies content to temporal file. Lat argument is to limit the amount of bytes that can be saved per chunked.</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Successive calls</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">@PUT
@Path("/chunkedUpload")
@Consumes("*/*")
@Produces(MediaType.APPLICATION_JSON)
public Response chunked(InputStream reader, @QueryParam("uploadId") String uploadId, @QueryParam("offset") Long offset) throws IOException {
  File file = new File(temporaryFolder.getRoot(), uploadId);

  if(isUploadIdValid(file)) {
    if(isOffsetValid(file, offset)) { <i class="conum" data-value="1"></i><b>(1)</b>
      long newOffset = IOUtil.copyToFile(file.toPath(), reader, Integer.MAX_VALUE); <i class="conum" data-value="2"></i><b>(2)</b>

      return Response.status(202).entity("{\n" +
        "  \"uploadId\": \""+uploadId+"\",\n" +
        "  \"offset\": " + (offset + newOffset) + "\n" +
        "}").build();

    } else {
      return Response.status(400).build();
    }
  } else {
    return Response.noContent().build();
  }
}

private boolean isOffsetValid(File file, long offset) {
  return file.length() == offset;
}

private boolean isUploadIdValid(File file) {
  return file.exists();
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Checks if <code>uploadId</code> exists and if the offset is correct.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Appends content to the already created file.</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Commit</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">@POST
@Path("/commitChunkedUpload")
@Consumes(MediaType.APPLICATION_JSON)
@Produces(MediaType.APPLICATION_JSON)
public Response commit(@QueryParam("uploadId") String uploadId, String content) {
  File file = new File(temporaryFolder.getRoot(), uploadId);

  if(isUploadIdValid(file)) {
    JsonReader parser = Json.createReader(new StringReader(content));
    JsonObject readObject = parser.readObject(); <i class="conum" data-value="1"></i><b>(1)</b>
    file.renameTo(new File(temporaryFolder.getRoot(), readObject.getString("filename"))); <i class="conum" data-value="2"></i><b>(2)</b>

    return Response.created(URI.create("/"+uploadId)).build();
  } else {
    return Response.noContent().build();
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Parses the <em>JSON</em> document-</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Gets filename provided and renames the uploaded file. Note that this operation can be insecure and should require security checks depending on project.</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_rest_polling_2"><a class="anchor" href="#_rest_polling_2"></a>4.9.6. REST Polling</h4>

</div>
<div class="sect3">
<h4 id="_security_2"><a class="anchor" href="#_security_2"></a>4.9.7. Security</h4>
<div class="sect4">
<h5 id="_authentication_2"><a class="anchor" href="#_authentication_2"></a>Authentication</h5>
<div class="paragraph">
<p>As mentioned in <a href="#_json_web_token">JSON Web Token</a> section, <em>JWT</em> is the approach used to secure RESTful Web Service endpoints.
For this example and to simplify things we are going to use the <em>JAX-RS 2.0</em> specification because it implements a concept called <strong>server filters</strong> that really fits our requirements.
Filters can be used when you want to modify any request or response parameters as well as implementing authorization strategies.</p>
</div>
<div class="paragraph">
<p>First thing is creating a class that represents our user and it must implements <code>java.security.Principal</code>.</p>
</div>
<div id="userclass" class="listingblock">
<div class="title">User.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">public class User implements Principal {

  private String username; <i class="conum" data-value="1"></i><b>(1)</b>

  private List&lt;String&gt; roles = new ArrayList&lt;String&gt;();

  public User(String username, String... roles) {
    super();
    this.username = username;
    this.roles = Arrays.asList(roles);
  }

  @Override
  public String getName() { <i class="conum" data-value="2"></i><b>(2)</b>
    return username;
  }

  public boolean isUserInRole(String role) { <i class="conum" data-value="3"></i><b>(3)</b>
    return this.roles.contains(role);
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>All required information about user can be set as attributes. In this example only username is required.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><code>Principal</code> has only one method to override and it is an string that identifies a user.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Checks if current user belongs to passed role.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Next step is create an <em>authentication</em> filter.
This filter is responsible of getting token from <code>x-access-token</code> header attribute, validate the token and get user information to be able to find the roles which belongs, and finally create the <strong>security context</strong> based on <em>jwt</em>.</p>
</div>
<div class="listingblock">
<div class="title">JWTAuthenticationFilter.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">@Provider <i class="conum" data-value="1"></i><b>(1)</b>
@Priority(Priorities.AUTHENTICATION) <i class="conum" data-value="2"></i><b>(2)</b>
public class JWTAuthenticationFilter implements ContainerRequestFilter { <i class="conum" data-value="3"></i><b>(3)</b>

  private static final List&lt;Class&lt;? extends Annotation&gt;&gt; securityAnnotations = Arrays.asList(DenyAll.class, PermitAll.class, RolesAllowed.class);

  @Context
  private ResourceInfo resourceInfo; <i class="conum" data-value="4"></i><b>(4)</b>

  @Override
  public void filter(ContainerRequestContext request) throws IOException {


      if(isSecuredResource()) { <i class="conum" data-value="5"></i><b>(5)</b>

        String token = request.getHeaderString("x-access-token"); <i class="conum" data-value="6"></i><b>(6)</b>

        try {
          String username = getUsernameFromToken(token); <i class="conum" data-value="7"></i><b>(7)</b>
          final User user = getUserByName(username); <i class="conum" data-value="8"></i><b>(8)</b>

          request.setSecurityContext(new SecurityContext() { <i class="conum" data-value="9"></i><b>(9)</b>

            @Override
            public boolean isUserInRole(String role) { return user.isUserInRoles(role);}

            @Override
            public boolean isSecure() { return false;}

            @Override public Principal getUserPrincipal() { return user;}

            @Override
            public String getAuthenticationScheme() { return SecurityContext.BASIC_AUTH;}
            });

        } catch (ParseException | JOSEException e) {
          request.abortWith(Responses.NOT_FOUND);
        }
      }
  }

  private boolean isSecuredResource() {

    for (Class&lt;? extends Annotation&gt; securityClass : securityAnnotations) {
      if(resourceInfo.getResourceMethod().isAnnotationPresent(securityClass)) {
        return true;
      }
    }

  for (Class&lt;? extends Annotation&gt; securityClass : securityAnnotations) {
      if(resourceInfo.getResourceClass().isAnnotationPresent(securityClass)) {
        return true;
      }
    }

    return false;
  }

  private String getUsernameFromToken(String token) throws ParseException, JOSEException {

    SignedJWT signedJWT = SignedJWT.parse(token); <i class="conum" data-value="10"></i><b>(10)</b>
    JWSVerifier verifier = new MACVerifier(SharedSecret.getSecret());

    if(signedJWT.verify(verifier)) {
      return signedJWT.getJWTClaimsSet().getSubject(); <i class="conum" data-value="11"></i><b>(11)</b>
    } else {
      throw new JOSEException("Firm is not verified.");
    }
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>To plug a filter you must annotate it with <code>@Provider</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Filter is executed during <strong>authentication</strong> phase.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Because filter is executed in server-side, it must implements <code>ContainerRequestFilter</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td><code>ResourceInfo</code> is injected to get information about endpoint method that is going to be called.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Checks if method is secured or not by verifying the presence of Java EE Security annotation.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>As described in <a href="#_json_web_token">JSON Web Token</a> section, <em>token</em> must be set in <code>x-access-token</code> header attribute.</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>Gets username value from <em>token</em>.</td>
</tr>
<tr>
<td><i class="conum" data-value="8"></i><b>8</b></td>
<td>With given username, the information about the <a href="#userclass">user</a> is returned from repository. Basically roles where user has access are returned.</td>
</tr>
<tr>
<td><i class="conum" data-value="9"></i><b>9</b></td>
<td>A custom <code>SecurityContext</code> class to verify if user has the expected roles.</td>
</tr>
<tr>
<td><i class="conum" data-value="10"></i><b>10</b></td>
<td>Parse the passed <em>token</em>.</td>
</tr>
<tr>
<td><i class="conum" data-value="11"></i><b>11</b></td>
<td>If <em>token</em> is valid and is verified as a <em>token</em> generated by the system, we can get the <em>subject</em> field. <em>Subject</em> claim field is used to save username.</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Nimbus JOSE + JWT</div>
<div class="paragraph">
<p>In this example we are using Nimbus JOSE + JWT library to create, parse, verify, &#8230;&#8203; <em>JWT</em> tokens.</p>
</div>
<div class="paragraph">
<p>Nimbus JOSE + JWT is an open source Java library which implements the Javascript Object Signing and Encryption (<em>JOSE</em>) spec suite and the closely related JSON Web Token (<em>JWT</em>) spec.</p>
</div>
<div class="paragraph">
<p>A full description can be read at <a href="http://connect2id.com/products/nimbus-jose-jwt" class="bare">http://connect2id.com/products/nimbus-jose-jwt</a></p>
</div>
</div>
</div>
<div class="paragraph">
<p>And finally an <em>authorization</em> filter.
This filter is responsible of ensuring that the user has the required rights to access to resource.</p>
</div>
<div class="listingblock">
<div class="title">RolesAllowedFilter.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">@Provider
@Priority(Priorities.AUTHORIZATION) <i class="conum" data-value="1"></i><b>(1)</b>
public class RolesAllowedFilter implements ContainerRequestFilter {

  private static final Response NOT_FOUND = Response.status(
      Response.Status.NOT_FOUND).entity("{\"message\": \"Resource Not Found\"}").build();

  @Context
  private ResourceInfo resourceInfo;

  @Override
  public void filter(ContainerRequestContext requestContext)
      throws IOException {
    Method resourceMethod = resourceInfo.getResourceMethod();

    // DenyAll on the method take precedence over RolesAllowed and PermitAll
    if (resourceMethod.isAnnotationPresent(DenyAll.class)) {
      requestContext.abortWith(NOT_FOUND);
      return;
    }

    // RolesAllowed on the method takes precedence over PermitAll
    RolesAllowed ra = resourceMethod.getAnnotation(RolesAllowed.class);
    if(assertRole(requestContext, ra)) { <i class="conum" data-value="2"></i><b>(2)</b>
      return;
    }

    // PermitAll takes precedence over RolesAllowed on the class
    if (resourceMethod.isAnnotationPresent(PermitAll.class)) {
      // Do nothing.
      return;
    }

    if (resourceInfo.getResourceClass().isAnnotationPresent(DenyAll.class)) {
      requestContext.abortWith(NOT_FOUND);
    }

    // RolesAllowed on the class takes precedence over PermitAll
    ra = resourceInfo.getResourceClass().getAnnotation(RolesAllowed.class);
    if(assertRole(requestContext, ra)) {
      return;
    }
  }

  private boolean assertRole(ContainerRequestContext requestContext, RolesAllowed ra) {

    if (ra != null) {
      String[] roles = ra.value();
      for (String role : roles) {
        if (requestContext.getSecurityContext().isUserInRole(role)) { <i class="conum" data-value="3"></i><b>(3)</b>
          return true;
        }
      }
      requestContext.abortWith(NOT_FOUND);
    }
    return false;
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Filter is executed during <strong>authentication</strong> phase.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Asserts if current user is in role list.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Uses <code>SecurityContext</code> provided in authentication phase, to check if current user is in endpoint role.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Having both classes in <em>classpath</em>, we can use <em>Java EE</em> security annotations to secure RESTful web services.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s see how to implement a <em>login</em> service.
Note that this service is not securized.</p>
</div>
<div class="listingblock">
<div class="title">UserResource.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">@Path("login")
public class UserResource {

  @POST
  @Consumes(MediaType.APPLICATION_JSON)
  @Produces(MediaType.APPLICATION_JSON)
  public Response login(JsonObject jsonObject) throws JOSEException {

    JsonString username = (JsonString) jsonObject.get("username"); <i class="conum" data-value="1"></i><b>(1)</b>
    JsonString password = (JsonString) jsonObject.get("password");

    if (authenticate(username.getString(), password.getString())) { <i class="conum" data-value="2"></i><b>(2)</b>

      String token = createToken(username.getString(), "example.com"); <i class="conum" data-value="3"></i><b>(3)</b>

      JsonObject responseDocument = Json.createObjectBuilder()
        .add("user", Json.createObjectBuilder().add("username", username).build())
        .add("token", token)
        .build(); <i class="conum" data-value="4"></i><b>(4)</b>

      return Response.ok(responseDocument).build();

    }

    return Response.status(Status.NOT_FOUND).build();

  }

  private String createToken(String subject, String issuer) throws JOSEException {

    JWSSigner signer = new MACSigner(SharedSecret.getSecret());

    JWTClaimsSet claimsSet = new JWTClaimsSet();
    claimsSet.setSubject(subject); <i class="conum" data-value="5"></i><b>(5)</b>
    claimsSet.setIssueTime(new Date());
    claimsSet.setIssuer(issuer);

    SignedJWT signedJWT = new SignedJWT(new JWSHeader(JWSAlgorithm.HS256), claimsSet);
    signedJWT.sign(signer);

    return signedJWT.serialize(); <i class="conum" data-value="6"></i><b>(6)</b>

  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><em>username</em> and <em>password</em> are sent as document body.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Authenticates given user and password.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Creates the <em>token</em> by using <em>example.com</em> domain as issuer.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Creates the response body document.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Sets username as <em>subject</em> of the <em>token</em>.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Returns the <em>token</em> as string.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>And a secured resource:</p>
</div>
<div class="listingblock">
<div class="title">BookResource.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java" data-lang="java">import javax.annotation.security.RolesAllowed;

@Path("/book")
public class BookResource {

  @GET
  @Produces(MediaType.APPLICATION_JSON)
  @RolesAllowed("admin") <i class="conum" data-value="1"></i><b>(1)</b>
  public String book() {
    //...
  }

  @GET
  @Path("/article")
  @Produces(MediaType.APPLICATION_JSON)
  @RolesAllowed("superadmin")
  public String article() {
    //...
  }

}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Only users with role <em>admin</em> can access to this resource.</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_bibliography"><a class="anchor" href="#_bibliography"></a>Bibliography</h2>
<div class="sectionbody">
<div class="ulist bibliography">
<ul class="bibliography">
<li>
<p><a id="jaxrs2"></a>[jaxrs2] Bill Burke. RESTful Java with JAX-RS 2.0, 2nd Edition. O&#8217;Reilly Media.</p>
</li>
<li>
<p><a id="restfulp"></a>[restfulp] Bhakti Mehta. RESTful Java Patterns and Best Practices. Packt.</p>
</li>
<li>
<p><a id="dontpatch"></a>[dontpatch] William Durand. Please. Don&#8217;t Patch Like An Idiot. <a href="http://williamdurand.fr/2014/02/14/please-do-not-patch-like-an-idiot/" class="bare">http://williamdurand.fr/2014/02/14/please-do-not-patch-like-an-idiot/</a></p>
</li>
<li>
<p><a id="rfc6902"></a>[rfc6902] Bryan &amp; Nottingham. RFC - 6902 - JavaScript Object Notation (JSON) Patch. <a href="http://tools.ietf.org/html/rfc6902" class="bare">http://tools.ietf.org/html/rfc6902</a></p>
</li>
<li>
<p><a id="rfc7231"></a>[rfc7231] Fielding &amp; Reschke.  RFC - 7231. <a href="http://tools.ietf.org/html/rfc7231" class="bare">http://tools.ietf.org/html/rfc7231</a></p>
</li>
<li>
<p><a id="bennadel"></a>[bennadel] Ben Nadel. HTTP Status Code For Invalid Data: 400 vs 422. <a href="http://www.bennadel.com/blog/2434-http-status-codes-for-invalid-data-400-vs-422.htm" class="bare">http://www.bennadel.com/blog/2434-http-status-codes-for-invalid-data-400-vs-422.htm</a></p>
</li>
<li>
<p><a id="rfc4918"></a>[rfc4918] Dusseault. RFC - 4918. <a href="http://tools.ietf.org/html/rfc4918" class="bare">http://tools.ietf.org/html/rfc4918</a></p>
</li>
<li>
<p><a id="githubdev"></a>[githubdev] Github. Github Dev. <a href="https://developer.github.com/v3/#client-errors" class="bare">https://developer.github.com/v3/#client-errors</a></p>
</li>
<li>
<p><a id="uber"></a>[uber] Uber - Uber Dev. <a href="https://developer.uber.com/v1/endpoints/" class="bare">https://developer.uber.com/v1/endpoints/</a></p>
</li>
<li>
<p><a id="headverb"></a>[headverb] Jason Harmon - RESTful Patterns for the HEAD verb. <a href="http://www.pragmaticapi.com/2013/02/14/restful-patterns-for-the-head-verb/" class="bare">http://www.pragmaticapi.com/2013/02/14/restful-patterns-for-the-head-verb/</a></p>
</li>
<li>
<p><a id="rfc2616"></a>[rfc2616] Fielding et al. RFC - 2616. <a href="https://www.ietf.org/rfc/rfc2616.txt" class="bare">https://www.ietf.org/rfc/rfc2616.txt</a></p>
</li>
<li>
<p><a id="restfulapidesign"></a>[restfulapidesign] Geert Jansen. Thoughts on RESTful API Design. <a href="http://restful-api-design.readthedocs.org/" class="bare">http://restful-api-design.readthedocs.org/</a></p>
</li>
<li>
<p><a id="realtimepagination"></a>[realtimepagination] Rakhitha Nimesh. Paginating Real-Time Data With Cursor Based Pagination. <a href="http://www.sitepoint.com/paginating-real-time-data-cursor-based-pagination/" class="bare">http://www.sitepoint.com/paginating-real-time-data-cursor-based-pagination/</a></p>
</li>
<li>
<p><a id="jsonwebtokenietf"></a>[jsonwebtokenietf] Jones et al. JSON Web Token (JWT). <a href="http://tools.ietf.org/html/draft-ietf-oauth-json-web-token-30" class="bare">http://tools.ietf.org/html/draft-ietf-oauth-json-web-token-30</a></p>
</li>
<li>
<p><a id="jsonwebtoken"></a>[jsonwebtoken] Lukas White. Using JSON Web Tokens with Node.js. <a href="http://www.sitepoint.com/using-json-web-tokens-node-js/" class="bare">http://www.sitepoint.com/using-json-web-tokens-node-js/</a></p>
</li>
<li>
<p><a id="jsontoken"></a>[jsontoken] Iain Porter. Writing REST services in Java: Security &amp; Authorization. <a href="http://porterhead.blogspot.com.es/2013/01/writing-rest-services-in-java-part-6.html" class="bare">http://porterhead.blogspot.com.es/2013/01/writing-rest-services-in-java-part-6.html</a></p>
</li>
<li>
<p><a id="ArquillianHome"></a>[ArquillianHome] Arquillian. Arquillian, <a href="http://arquillian.org/" class="bare">http://arquillian.org/</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_copyright_and_license"><a class="anchor" href="#_copyright_and_license"></a>Copyright and License</h2>
<div class="sectionbody">
<div class="imageblock">
<div class="content">
<img src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" alt="88x31">
</div>
</div>
</div>
</div>
</div>
<div id="footnotes">
<hr>
<div class="footnote" id="_footnote_1">
<a href="#_footnoteref_1">1</a>. You need to provide the binding library or rely on the one provided by <em>JAX-RS</em> provider.
</div>
</div>
<div id="footer">
<div id="footer-text">
Version 1.0<br>
Last updated 2015-03-13 15:56:08 CET
</div>
</div>
</body>
</html>